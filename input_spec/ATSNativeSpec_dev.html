

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ATS Native XML Input Specification V1 &mdash; ATS 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Input Specification" href="../input_spec.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ATS
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../demos.html">ATS Demo Problems</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../input_spec.html">Input Specification</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ATS Native XML Input Specification V1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#syntax-of-the-specification">Syntax of the Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#symbol-index">Symbol Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="#main">Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mesh">Mesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generatedmesh">GeneratedMesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#meshfromfile">MeshFromFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logicalmesh">LogicalMesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surfacemesh">SurfaceMesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subgridmeshes">SubgridMeshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#columnmeshes">ColumnMeshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sperrymesh">SperryMesh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#region">Region</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#point">Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="#box">Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plane">Plane</a></li>
<li class="toctree-l3"><a class="reference internal" href="#labeled-set">Labeled Set</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coordinator">Coordinator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checkpoint">Checkpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="#observation">Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pk">PK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#base-pks">Base PKs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pkphysicalbase">PKPhysicalBase</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pkbdfbase">PKBDFBase</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pkphysicalbdfbase">PKPhysicalBDFBase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#physical-pks">Physical PKs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flow-pks">Flow PKs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#energy-pks">Energy PKs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-energy-balance-pks">Surface Energy Balance PKs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#biogeochemistry">Biogeochemistry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deformation">Deformation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mpcs">MPCs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#weakmpc">WeakMPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strongmpc">StrongMPC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#physical-mpcs">Physical MPCs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coupled-water-mpc">Coupled Water MPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subsurface-mpc">Subsurface MPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#permafrost-mpc">Permafrost MPC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#state">State</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#field-evaluators">Field Evaluators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#primaryvariableevaluator">PrimaryVariableEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#independentvariableevaluator">IndependentVariableEvaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#water-content">Water Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-water-potential-surfaces">Surface Water potential surfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generic-evaluators">Generic Evaluators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initialconditions">InitialConditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-constant-scalars">Initialization of constant scalars</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-constant-vectors">Initialization of constant vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-scalar-fields">Initialization of scalar fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-of-tensor-fields">Initialization of tensor fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization-from-a-file">Initialization from a file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#boundaryconditions">BoundaryConditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flow-specific-boundary-conditions">Flow-specific Boundary Conditions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#time-integrators-solvers-and-other-mathematical-specs">Time integrators, solvers, and other mathematical specs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#timeintegrator">TimeIntegrator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#timestepcontrollerfixed">TimestepControllerFixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestepcontrollerstandard">TimestepControllerStandard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestepcontrollersmarter">TimestepControllerSmarter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestepcontrollerfromfile">TimestepControllerFromFile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linear-solver">Linear Solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#linear-solver-pcg">Linear Solver: PCG</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linear-solver-gmres">Linear Solver: GMRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linear-solver-nka">Linear Solver: NKA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linear-solver-amesos">Linear Solver: Amesos</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linear-solver-belos-gmres">Linear Solver: Belos GMRES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#preconditioner">Preconditioner</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hypre-s-boomer-amg">Hypre’s Boomer AMG</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trilinos-ml">Trilinos ML</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-ilu">Block ILU</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indentity">Indentity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nonlinearsolver">NonlinearSolver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-common-specs">Other Common Specs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ioevent">IOEvent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verboseobject">VerboseObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function">Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constant-function">Constant Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tabular-function">Tabular Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smooth-step-function">Smooth step Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#polynomial-function">Polynomial Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multi-variable-linear-function">Multi-variable linear Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#separable-function">Separable Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additive-function">Additive Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiplicative-function">Multiplicative Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#composition-function">Composition Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#piecewise-bilinear-function">Piecewise Bilinear Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distance-function">Distance Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monomial-function">Monomial Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#standard-math-function">Standard Math Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#operator">Operator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operatoraccumulation">OperatorAccumulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operatordiffusion">OperatorDiffusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operatoradvection">OperatorAdvection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ATS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../input_spec.html">Input Specification</a> &raquo;</li>
        
      <li>ATS Native XML Input Specification V1</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/input_spec/ATSNativeSpec_dev.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="ats-native-xml-input-specification-v1">
<h1><a class="toc-backref" href="#id4">ATS Native XML Input Specification V1</a><a class="headerlink" href="#ats-native-xml-input-specification-v1" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first"><strong>Table of Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#ats-native-xml-input-specification-v1" id="id4">ATS Native XML Input Specification V1</a></li>
<li><a class="reference internal" href="#syntax-of-the-specification" id="id5">Syntax of the Specification</a></li>
<li><a class="reference internal" href="#symbol-index" id="id6">Symbol Index</a></li>
<li><a class="reference internal" href="#main" id="id7">Main</a></li>
<li><a class="reference internal" href="#mesh" id="id8">Mesh</a><ul>
<li><a class="reference internal" href="#generatedmesh" id="id9">GeneratedMesh</a></li>
<li><a class="reference internal" href="#meshfromfile" id="id10">MeshFromFile</a></li>
<li><a class="reference internal" href="#logicalmesh" id="id11">LogicalMesh</a></li>
<li><a class="reference internal" href="#surfacemesh" id="id12">SurfaceMesh</a></li>
<li><a class="reference internal" href="#subgridmeshes" id="id13">SubgridMeshes</a></li>
<li><a class="reference internal" href="#columnmeshes" id="id14">ColumnMeshes</a></li>
<li><a class="reference internal" href="#sperrymesh" id="id15">SperryMesh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#region" id="id16">Region</a><ul>
<li><a class="reference internal" href="#point" id="id17">Point</a></li>
<li><a class="reference internal" href="#box" id="id18">Box</a></li>
<li><a class="reference internal" href="#plane" id="id19">Plane</a></li>
<li><a class="reference internal" href="#labeled-set" id="id20">Labeled Set</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinator" id="id21">Coordinator</a></li>
<li><a class="reference internal" href="#visualization" id="id22">Visualization</a></li>
<li><a class="reference internal" href="#checkpoint" id="id23">Checkpoint</a></li>
<li><a class="reference internal" href="#observation" id="id24">Observation</a></li>
<li><a class="reference internal" href="#pk" id="id25">PK</a><ul>
<li><a class="reference internal" href="#base-pks" id="id26">Base PKs</a><ul>
<li><a class="reference internal" href="#pkphysicalbase" id="id27">PKPhysicalBase</a></li>
<li><a class="reference internal" href="#pkbdfbase" id="id28">PKBDFBase</a></li>
<li><a class="reference internal" href="#pkphysicalbdfbase" id="id29">PKPhysicalBDFBase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-pks" id="id30">Physical PKs</a><ul>
<li><a class="reference internal" href="#flow-pks" id="id31">Flow PKs</a><ul>
<li><a class="reference internal" href="#richards-pk" id="id32">Richards PK</a></li>
<li><a class="reference internal" href="#permafrost-flow-pk" id="id33">Permafrost Flow PK</a></li>
<li><a class="reference internal" href="#overland-flow-head-primary-variable-pk" id="id34">Overland Flow, head primary variable PK</a></li>
<li><a class="reference internal" href="#overland-flow-pressure-primary-variable-pk" id="id35">Overland Flow, pressure primary variable, PK</a></li>
<li><a class="reference internal" href="#snow-distribution-pk" id="id36">Snow Distribution PK</a></li>
</ul>
</li>
<li><a class="reference internal" href="#energy-pks" id="id37">Energy PKs</a><ul>
<li><a class="reference internal" href="#advection-diffusion-pk" id="id38">Advection Diffusion PK</a></li>
<li><a class="reference internal" href="#energy-base-pk" id="id39">Energy Base PK</a></li>
<li><a class="reference internal" href="#two-phase-subsurface-energy-pk" id="id40">Two-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#three-phase-subsurface-energy-pk" id="id41">Three-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#id1" id="id42">Three-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#surface-ice-energy-pk" id="id43">Surface Ice Energy PK</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-energy-balance-pks" id="id44">Surface Energy Balance PKs</a><ul>
<li><a class="reference internal" href="#surface-energy-balance-snow-monolithic-version" id="id45">Surface Energy Balance / Snow – Monolithic Version</a></li>
<li><a class="reference internal" href="#surface-energy-balance-generic-version" id="id46">Surface Energy Balance – Generic Version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#biogeochemistry" id="id47">Biogeochemistry</a><ul>
<li><a class="reference internal" href="#biogeochemistry-monolithic-version" id="id48">Biogeochemistry – Monolithic Version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deformation" id="id49">Deformation</a><ul>
<li><a class="reference internal" href="#volumetric-deformation" id="id50">Volumetric Deformation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mpcs" id="id51">MPCs</a><ul>
<li><a class="reference internal" href="#weakmpc" id="id52">WeakMPC</a></li>
<li><a class="reference internal" href="#strongmpc" id="id53">StrongMPC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-mpcs" id="id54">Physical MPCs</a><ul>
<li><a class="reference internal" href="#coupled-water-mpc" id="id55">Coupled Water MPC</a></li>
<li><a class="reference internal" href="#subsurface-mpc" id="id56">Subsurface MPC</a></li>
<li><a class="reference internal" href="#permafrost-mpc" id="id57">Permafrost MPC</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#state" id="id58">State</a><ul>
<li><a class="reference internal" href="#field-evaluators" id="id59">Field Evaluators</a><ul>
<li><a class="reference internal" href="#primaryvariableevaluator" id="id60">PrimaryVariableEvaluator</a></li>
<li><a class="reference internal" href="#independentvariableevaluator" id="id61">IndependentVariableEvaluator</a><ul>
<li><a class="reference internal" href="#from-function" id="id62">From Function</a></li>
<li><a class="reference internal" href="#from-file" id="id63">From File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#water-content" id="id64">Water Content</a><ul>
<li><a class="reference internal" href="#richards-equation-water-content" id="id65">Richards Equation water content</a></li>
<li><a class="reference internal" href="#liquid-gas-water-content" id="id66">Liquid+Gas water content</a></li>
<li><a class="reference internal" href="#liquid-ice-water-content" id="id67">Liquid+Ice water content</a></li>
<li><a class="reference internal" href="#liquid-ice-gas-water-content" id="id68">Liquid+Ice+Gas water content</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-water-potential-surfaces" id="id69">Surface Water potential surfaces</a><ul>
<li><a class="reference internal" href="#surfaceelevation" id="id70">SurfaceElevation</a></li>
<li><a class="reference internal" href="#surfacepotential" id="id71">SurfacePotential</a></li>
<li><a class="reference internal" href="#snowsurfacepotential" id="id72">SnowSurfacePotential</a></li>
<li><a class="reference internal" href="#surface-water-content" id="id73">Surface water content</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generic-evaluators" id="id74">Generic Evaluators</a><ul>
<li><a class="reference internal" href="#additive" id="id75">Additive</a></li>
<li><a class="reference internal" href="#multiplicative" id="id76">Multiplicative</a></li>
<li><a class="reference internal" href="#column-summation" id="id77">Column summation</a></li>
<li><a class="reference internal" href="#subgrid-disaggregation" id="id78">Subgrid disaggregation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#initialconditions" id="id79">InitialConditions</a><ul>
<li><a class="reference internal" href="#initialization-of-constant-scalars" id="id80">Initialization of constant scalars</a></li>
<li><a class="reference internal" href="#initialization-of-constant-vectors" id="id81">Initialization of constant vectors</a></li>
<li><a class="reference internal" href="#initialization-of-scalar-fields" id="id82">Initialization of scalar fields</a></li>
<li><a class="reference internal" href="#initialization-of-tensor-fields" id="id83">Initialization of tensor fields</a></li>
<li><a class="reference internal" href="#initialization-from-a-file" id="id84">Initialization from a file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boundaryconditions" id="id85">BoundaryConditions</a><ul>
<li><a class="reference internal" href="#flow-specific-boundary-conditions" id="id86">Flow-specific Boundary Conditions</a><ul>
<li><a class="reference internal" href="#dirichlet-pressure-boundary-conditions" id="id87">Dirichlet (pressure) boundary conditions</a></li>
<li><a class="reference internal" href="#neumann-mass-flux-boundary-conditions" id="id88">Neumann (mass flux) boundary conditions</a></li>
<li><a class="reference internal" href="#seepage-face-boundary-conditions" id="id89">Seepage face boundary conditions</a></li>
<li><a class="reference internal" href="#dirichlet-head-boundary-conditions" id="id90">Dirichlet (head) boundary conditions</a></li>
<li><a class="reference internal" href="#fixed-level-boundary-conditions" id="id91">Fixed level boundary conditions</a></li>
<li><a class="reference internal" href="#zero-head-gradient-boundary-conditions" id="id92">Zero head gradient boundary conditions</a></li>
<li><a class="reference internal" href="#critical-depth-boundary-conditions" id="id93">Critical depth boundary conditions</a></li>
<li><a class="reference internal" href="#dynamic-boundary-condutions" id="id94">Dynamic boundary condutions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#time-integrators-solvers-and-other-mathematical-specs" id="id95">Time integrators, solvers, and other mathematical specs</a><ul>
<li><a class="reference internal" href="#timeintegrator" id="id96">TimeIntegrator</a><ul>
<li><a class="reference internal" href="#timestepcontrollerfixed" id="id97">TimestepControllerFixed</a></li>
<li><a class="reference internal" href="#timestepcontrollerstandard" id="id98">TimestepControllerStandard</a></li>
<li><a class="reference internal" href="#timestepcontrollersmarter" id="id99">TimestepControllerSmarter</a></li>
<li><a class="reference internal" href="#timestepcontrollerfromfile" id="id100">TimestepControllerFromFile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-solver" id="id101">Linear Solver</a><ul>
<li><a class="reference internal" href="#linear-solver-pcg" id="id102">Linear Solver: PCG</a></li>
<li><a class="reference internal" href="#linear-solver-gmres" id="id103">Linear Solver: GMRES</a></li>
<li><a class="reference internal" href="#linear-solver-nka" id="id104">Linear Solver: NKA</a></li>
<li><a class="reference internal" href="#linear-solver-amesos" id="id105">Linear Solver: Amesos</a></li>
<li><a class="reference internal" href="#linear-solver-belos-gmres" id="id106">Linear Solver: Belos GMRES</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preconditioner" id="id107">Preconditioner</a><ul>
<li><a class="reference internal" href="#hypre-s-boomer-amg" id="id108">Hypre’s Boomer AMG</a></li>
<li><a class="reference internal" href="#trilinos-ml" id="id109">Trilinos ML</a></li>
<li><a class="reference internal" href="#block-ilu" id="id110">Block ILU</a></li>
<li><a class="reference internal" href="#indentity" id="id111">Indentity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nonlinearsolver" id="id112">NonlinearSolver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-common-specs" id="id113">Other Common Specs</a><ul>
<li><a class="reference internal" href="#ioevent" id="id114">IOEvent</a></li>
<li><a class="reference internal" href="#verboseobject" id="id115">VerboseObject</a></li>
<li><a class="reference internal" href="#function" id="id116">Function</a><ul>
<li><a class="reference internal" href="#constant-function" id="id117">Constant Function</a></li>
<li><a class="reference internal" href="#tabular-function" id="id118">Tabular Function</a></li>
<li><a class="reference internal" href="#smooth-step-function" id="id119">Smooth step Function</a></li>
<li><a class="reference internal" href="#polynomial-function" id="id120">Polynomial Function</a></li>
<li><a class="reference internal" href="#multi-variable-linear-function" id="id121">Multi-variable linear Function</a></li>
<li><a class="reference internal" href="#separable-function" id="id122">Separable Function</a></li>
<li><a class="reference internal" href="#additive-function" id="id123">Additive Function</a></li>
<li><a class="reference internal" href="#multiplicative-function" id="id124">Multiplicative Function</a></li>
<li><a class="reference internal" href="#composition-function" id="id125">Composition Function</a></li>
<li><a class="reference internal" href="#piecewise-bilinear-function" id="id126">Piecewise Bilinear Function</a></li>
<li><a class="reference internal" href="#distance-function" id="id127">Distance Function</a></li>
<li><a class="reference internal" href="#monomial-function" id="id128">Monomial Function</a></li>
<li><a class="reference internal" href="#standard-math-function" id="id129">Standard Math Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operator" id="id130">Operator</a><ul>
<li><a class="reference internal" href="#operatoraccumulation" id="id131">OperatorAccumulation</a></li>
<li><a class="reference internal" href="#operatordiffusion" id="id132">OperatorDiffusion</a></li>
<li><a class="reference internal" href="#operatoradvection" id="id133">OperatorAdvection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="syntax-of-the-specification">
<h1><a class="toc-backref" href="#id5">Syntax of the Specification</a><a class="headerlink" href="#syntax-of-the-specification" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>Input specification for each ParameterList entry consists of two parts.
First, a bulleted list defines the usage syntax and available options.
This is followed by example snipets of XML code to demonstrate usage.</li>
<li>In many cases, the input specifies data for a particular parameterized model, and ATS
supports a number of parameterizations.
For example, initial data might be uniform (the value is required), or linear in y (the value
and its gradient are required).
Where ATS supports a number of parameterized models for quantity Z, the available
models will be listed by name, and then will be described in the subsequent section.
For example, the specification for an <cite>“X</cite>” list might begin with the following:<ul>
<li><cite>“Y</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“default_value”</strong>, <cite>“other</cite>”, <cite>“valid</cite>”, <cite>“options</cite>”</li>
<li>Z <code class="docutils literal notranslate"><span class="pre">[Z-spec]</span></code> Model for Z, choose exactly one of the following: (1) <cite>“z1</cite>”, or (2) <cite>“z2</cite>” (see below)</li>
</ul>
</li>
</ul>
<p>Here, an <cite>“X</cite>” is defined by a <cite>“Y</cite>” and a <cite>“Z</cite>”.
The <cite>“Y</cite>” is a string parameter but the <cite>“Z</cite>” is given by a model (which will require its own set of parameters).
The options for <cite>“Z</cite>” will then be described as a spec:</p>
<blockquote>
<div><ul class="simple">
<li><cite>“z1</cite>” applies model z1.  Requires <cite>“z1a</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code></li>
<li><cite>“z2</cite>” applies model z2.  Requires <cite>“z2a</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> and <cite>“z2b</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code></li>
</ul>
</div></blockquote>
<p>An example of using such a specification:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;X&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Y&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;hello&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;z2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;z2a&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.7&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;z2b&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Here, the user is defining X with Y=”hello”, and Z will be a z2 constructed with z2a=0.7 and z2b=3.</p>
<p>Conventions:</p>
<ul class="simple">
<li>Reserved keywords and labels are <cite>“quoted and italicized</cite>” – these
labels or values of parameters in user-generated input files must
match (using XML matching rules) the specified or allowable values.</li>
<li>User-defined labels are indicated with ALL-CAPS, and are meant to
represent a typical name given by a user - these can be names or
numbers or whatever serves best the organization of the user input
data.</li>
<li>Bold values are default values, and are used if the Parameter
is not provided.</li>
</ul>
</div>
<div class="section" id="symbol-index">
<h1><a class="toc-backref" href="#id6">Symbol Index</a><a class="headerlink" href="#symbol-index" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math notranslate nohighlight">\(g\)</span></td>
<td>gravitational acceleration vector <span class="math notranslate nohighlight">\([m s^-2]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(h\)</span></td>
<td>ponded depth, or the water head over the surface <span class="math notranslate nohighlight">\([m]\)</span></td>
</tr>
<tr class="row-even"><td></td>
<td>alternative, in context of the subsurface, water head <span class="math notranslate nohighlight">\([m]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(h_{snow}\)</span></td>
<td>snow depth <span class="math notranslate nohighlight">\([m]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(K\)</span></td>
<td>absolute permeability <span class="math notranslate nohighlight">\([m^2]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(k_r\)</span></td>
<td>relative permeability <span class="math notranslate nohighlight">\([-]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(n_X\)</span></td>
<td>molar density of phase X <span class="math notranslate nohighlight">\([mol m^-3]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(p\)</span></td>
<td>pressure of the liquid phase <span class="math notranslate nohighlight">\([Pa]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(P_{s,r}\)</span></td>
<td>precipitation of rain or snow, noting that snow is always a precipitation rate in snow-water-equivalent (SWE) basis.  <span class="math notranslate nohighlight">\([m s^-1]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(Q_w\)</span></td>
<td>mass source of water <span class="math notranslate nohighlight">\([mol s^-1]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(s_X\)</span></td>
<td>saturation of phase X <span class="math notranslate nohighlight">\([-]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(t\)</span></td>
<td>time variable <span class="math notranslate nohighlight">\([s]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(z\)</span></td>
<td>elevation <span class="math notranslate nohighlight">\([m]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\nu\)</span></td>
<td>dynamic viscosity of water <span class="math notranslate nohighlight">\([Pa s]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\phi\)</span></td>
<td>porosity of the soil <span class="math notranslate nohighlight">\([-]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\rho\)</span></td>
<td>mass density of a phase <span class="math notranslate nohighlight">\([kg m^-3]\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\Theta\)</span></td>
<td>extensive water content of a cell <span class="math notranslate nohighlight">\([mol]\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\vert E \vert\)</span></td>
<td>volume of a discrete element <span class="math notranslate nohighlight">\(E\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="main">
<h1><a class="toc-backref" href="#id7">Main</a><a class="headerlink" href="#main" title="Permalink to this headline">¶</a></h1>
<p>The <cite>“main</cite>” ParameterList frames the entire input spec, and must contain
one sublist for each of the following sections.</p>
<ul>
<li><p class="first"><cite>“mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[mesh-spec]</span></code>  See the <a class="reference internal" href="#mesh">Mesh</a> spec.</p>
</li>
<li><p class="first"><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<p>List of multiple <a class="reference internal" href="#region">Region</a> specs, each in its own sublist named uniquely by the user.</p>
</li>
<li><p class="first"><cite>“coordinator</cite>” <code class="docutils literal notranslate"><span class="pre">[coordinator-spec]</span></code>  See the <a class="reference internal" href="#coordinator">Coordinator</a> spec.</p>
</li>
<li><p class="first"><cite>“visualization</cite>” <code class="docutils literal notranslate"><span class="pre">[visualization-spec]</span></code> A <a class="reference internal" href="#visualization">Visualization</a> spec for the main mesh/domain.</p>
</li>
<li><p class="first"><cite>“visualization XX</cite>” <code class="docutils literal notranslate"><span class="pre">[visualization-spec]</span></code></p>
<p>Potentially more than one other <a class="reference internal" href="#visualization">Visualization</a> specs, one for each domain <cite>“XX</cite>”.  e.g. <cite>“surface</cite>”</p>
</li>
<li><p class="first"><cite>“checkpoint</cite>” <code class="docutils literal notranslate"><span class="pre">[checkpoint-spec]</span></code> A <a class="reference internal" href="#checkpoint">Checkpoint</a> spec.</p>
</li>
<li><p class="first"><cite>“observations</cite>” <code class="docutils literal notranslate"><span class="pre">[observation-spec]</span></code> An <a class="reference internal" href="#observation">Observation</a> spec.</p>
</li>
<li><p class="first"><cite>“PKs</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<p>A list containing exactly one sublist, a <a class="reference internal" href="#pk">PK</a> spec with the top level PK.</p>
</li>
<li><p class="first"><cite>“state</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> A <a class="reference internal" href="#state">State</a> spec.</p>
</li>
</ul>
</div>
<div class="section" id="mesh">
<h1><a class="toc-backref" href="#id8">Mesh</a><a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Simple wrapper that takes a ParameterList and generates all needed meshes.</div></blockquote>
<p>All processes are simulated on a domain, which is discretized through a mesh.</p>
<p>Multiple domains and therefore meshes can be used in a single simulation, and
multiple meshes can be constructed on the fly.</p>
<p>The base mesh represents the primary domain of simulation.  Simple, structured
meshes may be generated on the fly, or complex unstructured meshes are
provided as <code class="docutils literal notranslate"><span class="pre">Exodus</span> <span class="pre">II</span></code> files.  The base <em>mesh</em> list includes either a
<a class="reference internal" href="#generatedmesh">GeneratedMesh</a>,  <a class="reference internal" href="#meshfromfile">MeshFromFile</a>, or <a class="reference internal" href="#logicalmesh">LogicalMesh</a> spec, as described below.</p>
<p>Additionally, a <a class="reference internal" href="#surfacemesh">SurfaceMesh</a> may be formed by lifting the surface of a
provided mesh and then flattening that mesh to a 2D surface.  <a class="reference internal" href="#columnmeshes">ColumnMeshes</a>
which split a base mesh into vertical columns of cells for use in 1D models
may also be generated automatically.</p>
<p>Finally, mesh generation is hard and error-prone.  A mesh audit is provided,
which checks for many common geometric and topologic errors in mesh
generation.  This is reasonably fast, even for big meshes, and can be done
through providing a “verify mesh” option.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-typed-spec]</span></code></p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>“mesh type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of <cite>“generate mesh</cite>”, <cite>“read mesh file</cite>”,</dt>
<dd><cite>“logical</cite>”, <cite>“surface</cite>”, <cite>“subgrid</cite>”, or <cite>“column</cite>”.</dd>
</dl>
</li>
<li><cite>“_mesh_type_ parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[_mesh_type_-spec]</span></code> List of parameters
associated with the type.</li>
<li><cite>“verify mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Perform a mesh audit.</li>
<li><cite>“deformable mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Will this mesh be deformed?</li>
</ul>
<div class="section" id="generatedmesh">
<h2><a class="toc-backref" href="#id9">GeneratedMesh</a><a class="headerlink" href="#generatedmesh" title="Permalink to this headline">¶</a></h2>
<p>Generated mesh are by definition structured, with uniform dx, dy, and dz.
Such a mesh is specified by a bounding box high and low coordinate, and a list
of number of cells in each direction.</p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“generate mesh</cite>”.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-type-generate-mesh-spec]</span></code></p>
<ul class="simple">
<li><cite>“domain low coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of low corner of domain</li>
<li><cite>“domain high coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of high corner of domain</li>
<li><cite>“number of cells</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the number of uniform cells in each coordinate direction</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;generate mesh&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;generate mesh parameters&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of cells&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100, 1, 100}}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;domain low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 0.0, 0.0}}&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;domain high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 1.0, 10.0}}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="meshfromfile">
<h2><a class="toc-backref" href="#id10">MeshFromFile</a><a class="headerlink" href="#meshfromfile" title="Permalink to this headline">¶</a></h2>
<p>Meshes can be pre-generated in a multitude of ways, then written to “Exodus
II” file format, and loaded in ATS.</p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“read mesh file</cite>”.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-type-read-mesh-file-spec]</span></code></p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of pre-generated mesh file. Note that in the case of an</dt>
<dd>Exodus II mesh file, the suffix of the serial mesh file must be .exo and
the suffix of the parallel mesh file must be .par.
When running in serial the code will read this the indicated file directly.
When running in parallel and the suffix is .par, the code will instead read
the partitioned files, that have been generated with a Nemesis tool and
named as filename.par.N.r where N is the number of processors and r is the rank.
When running in parallel and the suffix is .exo, the code will partition automatically
the serial file.</dd>
</dl>
</li>
<li><cite>“format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> format of pre-generated mesh file (<cite>“MSTK</cite>” or <cite>“Exodus II</cite>”)</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;read mesh file&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file parameters&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_filename.exo&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verify mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="logicalmesh">
<h2><a class="toc-backref" href="#id11">LogicalMesh</a><a class="headerlink" href="#logicalmesh" title="Permalink to this headline">¶</a></h2>
<p>** Document me! **</p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“logical</cite>”.</p>
</div>
<div class="section" id="surfacemesh">
<h2><a class="toc-backref" href="#id12">SurfaceMesh</a><a class="headerlink" href="#surfacemesh" title="Permalink to this headline">¶</a></h2>
<p>To lift a surface off of the mesh, a side-set specifying all surface faces
must be given.  These faces are lifted locally, so the partitioning of the
surface cells will be identical to the partitioning of the subsurface faces
that correspond to these cells.  All communication and ghost cells are set up.
The mesh is flattened, so all surface faces must have non-zero area when
projected in the z-direction.  No checks for holes are performed.  Surface
meshes may similarly be audited to make sure they are reasonable for
computation.</p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“surface</cite>”.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-type-surface-spec]</span></code></p>
<ul class="simple">
<li><cite>“surface sideset name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> The <a class="reference internal" href="#region">Region</a> name containing all surface faces.</li>
<li><cite>“surface sideset names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> A list of <a class="reference internal" href="#region">Region</a> names containing the surface faces.  Either this or the singular version must be specified.</li>
<li><cite>“verify mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Verify validity of surface mesh.</li>
<li><cite>“export mesh to file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Export the lifted surface mesh to this filename.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;surface&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;surface parameters&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;surface sideset name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;{surface_region}&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verify mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;export mesh to file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface_mesh.exo&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;read mesh file&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file parameters&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;../data/open-book-2D.exo&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="subgridmeshes">
<h2><a class="toc-backref" href="#id13">SubgridMeshes</a><a class="headerlink" href="#subgridmeshes" title="Permalink to this headline">¶</a></h2>
<p>A collection of meshes formed by associating a new mesh with each entity of a
region.  Used for a few cases, including generating a 1D column for each
surface face of a semi-structured subsurface mesh, or for hanging logical
meshes off of each surface cell as a subgrid model, etc.</p>
<p>The subgrid meshes are then named <cite>“MESH_NAME_X”</cite> for each X, which is an
entity local ID, in a provided region of the provided entity type.</p>
<p><strong>DOCUMENT ME How is the subgrid mesh type specified?  Add examples for Columns and Transport Subgrid model!</strong></p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“subgrid</cite>”.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-type-subgrid-spec]</span></code></p>
<ul class="simple">
<li><cite>“subgrid region name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Region on which each subgrid mesh will be associated.</li>
<li><dl class="first docutils">
<dt><cite>“entity kind</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of <cite>“cell</cite>”, <cite>“face</cite>”, etc.  Entity of the region (usually</dt>
<dd><cite>“cell</cite>”) on which each subgrid mesh will be associated.</dd>
</dl>
</li>
<li><cite>“parent domain</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>domain</strong> Mesh which includes the above region.</li>
<li><cite>“flyweight mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>False</strong> NOT SUPPORTED?  Allows a single mesh instead of one per entity.</li>
</ul>
</div>
<div class="section" id="columnmeshes">
<h2><a class="toc-backref" href="#id14">ColumnMeshes</a><a class="headerlink" href="#columnmeshes" title="Permalink to this headline">¶</a></h2>
<p>Note these are never? created manually by a user.  Instead use SubgridMeshes,
which generate a <a href="#id134"><span class="problematic" id="id135">ColumnMesh_</span></a> spec for every face of the surface mesh.</p>
<p>Specified by <cite>“mesh type</cite>” of <cite>“column</cite>”.</p>
<p><code class="docutils literal notranslate"><span class="pre">[mesh-type-column-spec]</span></code></p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>“parent domain</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> The <a class="reference internal" href="#mesh">Mesh</a> name of the 3D mesh from which columns are generated.</dt>
<dd>Note that the <cite>“build columns from set</cite>” parameter must be set in that mesh.</dd>
</dl>
</li>
<li><cite>“verify mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Verify validity of surface mesh.</li>
<li><cite>“deformable mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong>  Used for deformation PKs to allow non-const access.</li>
<li><cite>“entity LID</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Local ID of the surface cell that is the top of the column.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;column&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;column parameters&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;parent domain&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;domain&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;entity LID&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;read mesh file&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file parameters&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;../data/open-book-2D.exo&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="sperrymesh">
<h2><a class="toc-backref" href="#id15">SperryMesh</a><a class="headerlink" href="#sperrymesh" title="Permalink to this headline">¶</a></h2>
<p>A mesh based on the Sperry et al 98 and Christoffersen et al 16 papers.  Hard
coded currently for simplicity, this is ongoing work and will change a lot.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;mesh type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Sperry 1D column&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="region">
<h1><a class="toc-backref" href="#id16">Region</a><a class="headerlink" href="#region" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Region: a geometric or discrete subdomain (abstract)</div></blockquote>
<p>Regions are geometrical constructs used in Amanzi to define subsets of
the computational domain in order to specify the problem to be solved, and the
output desired. Regions may represents zero-, one-, two- or three-dimensional
subsets of physical space.  for a three-dimensional problem, the simulation
domain will be a three-dimensional region bounded by a set of two-dimensional
regions.  If the simulation domain is N-dimensional, the boundary conditions
must be specified over a set of regions are (N-1)-dimensional.</p>
<p>Amanzi automatically defines the special region labeled <em>All</em>, which is the
entire simulation domain. Currently, the unstructured framework does
not support the <em>All</em> region, but it is expected to do so in the
near future.</p>
<p>Amanzi supports parameterized forms for a number of analytic shapes, as well
as more complex definitions based on triangulated surface files.</p>
<p>ONE OF:
* <cite>“region: box</cite>” <code class="docutils literal notranslate"><span class="pre">[region-box-spec]</span></code>
OR:
* <cite>“region: plane</cite>” <code class="docutils literal notranslate"><span class="pre">[region-plane-spec]</span></code>
OR:
* <cite>“region: labeled set</cite>” <code class="docutils literal notranslate"><span class="pre">[region-labeled-set-spec]</span></code>
OR:
* <cite>“region: color function</cite>” <code class="docutils literal notranslate"><span class="pre">[region-color-function-spec]</span></code>
OR:
* <cite>“region: point</cite>” <code class="docutils literal notranslate"><span class="pre">[region-point-spec]</span></code>
OR:
* <cite>“region: logical</cite>” <code class="docutils literal notranslate"><span class="pre">[region-logical-spec]</span></code>
OR:
* <cite>“region: polygon</cite>” <code class="docutils literal notranslate"><span class="pre">[region-polygon-spec]</span></code>
OR:
* <cite>“region: enumerated</cite>” <code class="docutils literal notranslate"><span class="pre">[region-enumerated-spec]</span></code>
OR:
* <cite>“region: all</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code>
OR:
* <cite>“region: boundary</cite>” <code class="docutils literal notranslate"><span class="pre">[region-boundary-spec]</span></code>
OR:
* <cite>“region: box volume fractions</cite>” <code class="docutils literal notranslate"><span class="pre">[region-box-volume-fractions-spec]</span></code>
OR:
* <cite>“region: line segment</cite>” <code class="docutils literal notranslate"><span class="pre">[region-line-segment-spec]</span></code>
END</p>
<p>Notes:</p>
<ul>
<li><p class="first">Surface files contain labeled triangulated face sets.  The user is
responsible for ensuring that the intersections with other surfaces
in the problem, including the boundaries, are <em>exact</em> (<em>i.e.</em> that
surface intersections are <em>watertight</em> where applicable), and that
the surfaces are contained within the computational domain.  If
nodes in the surface fall outside the domain, the elements they
define are ignored.</p>
<p>Examples of surface files are given in the <em>Exodus II</em> file
format here.</p>
</li>
<li><p class="first">Region names must NOT be repeated.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span>  <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;TOP SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 8}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;MIDDLE SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 3}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 5}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BOTTOM SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 0}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 3}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;INFLOW SURFACE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;label&quot;</span>  <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sideset_2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span>   <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;F_area_mesh.exo&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;entity&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;OUTFLOW PLANE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;point&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;normal&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0, 0, 1}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BLOODY SAND&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;F_area_col.txt&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;25&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;FLUX PLANE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: polygon&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of points&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;points&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.8, 0.0, 0.0,</span>
<span class="s">                                                               0.5,  0.5, 0.5,</span>
<span class="s">                                                              -0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, <em>TOP SESCTION</em>, <em>MIDDLE SECTION</em> and <em>BOTTOM SECTION</em>
are three box-shaped volumetric regions. <em>INFLOW SURFACE</em> is a
surface region defined in an Exodus II-formatted labeled set
file and <em>OUTFLOW PLANE</em> is a planar region. <em>BLOODY SAND</em> is a volumetric
region defined by the value 25 in color function file.</p>
<div class="section" id="point">
<h2><a class="toc-backref" href="#id17">Point</a><a class="headerlink" href="#point" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>RegionPoint: a point in space.</div></blockquote>
<p>List <em>region: point</em> defines a point in space.
This region consists of cells containing this point.</p>
<ul class="simple">
<li><cite>“coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of point in space.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DOWN_WIND150&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- parent list defining the name --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: point&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-150.0, 0.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="box">
<h2><a class="toc-backref" href="#id18">Box</a><a class="headerlink" href="#box" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>RegionBox: a rectangular region in space, defined by two corners</div></blockquote>
<p>List <em>region: box</em> defines a region bounded by coordinate-aligned
planes. Boxes are allowed to be of zero thickness in only one
direction in which case they are equivalent to planes.</p>
<ul class="simple">
<li><cite>“low coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the boundary point with the lowest coordinates.</li>
<li><cite>“high coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the boundary points with the highest coordinates.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;WELL&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-5.0,-5.0, -5.0}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{5.0, 5.0,  5.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="plane">
<h2><a class="toc-backref" href="#id19">Plane</a><a class="headerlink" href="#plane" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>RegionPlane: A planar (infinite) region in space, defined by a point and a normal.</div></blockquote>
<p>List <em>region: plane</em> defines a plane using a point lying on the plane and normal to the plane.</p>
<ul class="simple">
<li><cite>“normal</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Normal to the plane.</li>
<li><cite>“point</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point in space.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;TOP_SECTION&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;point&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;normal&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{1, 1, 0}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;tolerance&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="labeled-set">
<h2><a class="toc-backref" href="#id20">Labeled Set</a><a class="headerlink" href="#labeled-set" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>RegionLabeledSet: A region defined by a set of mesh entities in a mesh file</div></blockquote>
<p>The list <em>region: labeled set</em> defines a named set of mesh entities
existing in an input mesh file. This is the same file that contains
the computational mesh. The name of the entity set is given
by <em>label</em>.  For example, a mesh file in the Exodus II
format can be processed to tag cells, faces and/or nodes with
specific labels, using a variety of external tools. Regions based
on such sets are assigned a user-defined label for Amanzi, which may
or may not correspond to the original label in the exodus file.
Note that the file used to express this labeled set may be in any
Amanzi-supported mesh format (the mesh format is specified in the
parameters for this option).  The <em>entity</em> parameter may be
necessary to specify a unique set.  For example, an Exodus file
requires <em>cell</em>, <em>face</em> or <em>node</em> as well as a label (which is
an integer).  The resulting region will have the dimensionality
associated with the entities in the indicated set.</p>
<ul class="simple">
<li><cite>“label</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Set per label defined in the mesh file.</li>
<li><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> File name.</li>
<li><cite>“format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Currently, we only support mesh files in the “Exodus II” format.</li>
<li><cite>“entity</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the mesh object (cell, face, etc).</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;AQUIFER&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;entity&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;porflow4_4.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;label&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="coordinator">
<h1><a class="toc-backref" href="#id21">Coordinator</a><a class="headerlink" href="#coordinator" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Simulation controller and top-level driver</div></blockquote>
<p>In the <cite>“cycle driver</cite>” sublist, the user specifies global control of the
simulation, including starting and ending times and restart options.</p>
<ul class="simple">
<li><cite>“start time</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.</strong> Specifies the start of time in model time.</li>
<li><cite>“start time units</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“s”</strong> One of <cite>“s</cite>”, <cite>“d</cite>”, or <cite>“yr</cite>”</li>
<li><cite>“end time</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Specifies the end of the simulation in model time.</li>
<li><cite>“end time units</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“s”</strong> One of <cite>“s</cite>”, <cite>“d</cite>”, or <cite>“yr</cite>”</li>
<li><dl class="first docutils">
<dt><cite>“end cycle</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>optional</strong> If provided, specifies the end of the</dt>
<dd>simulation in timestep cycles.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>“restart from checkpoint file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>optional</strong> If provided,</dt>
<dd>specifies a path to the checkpoint file to continue a stopped simulation.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>“wallclock duration [hrs]</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>optional</strong> After this time, the</dt>
<dd>simulation will checkpoint and end.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>“required times</cite>” <code class="docutils literal notranslate"><span class="pre">[io-event-spec]</span></code> <strong>optional</strong> An <a class="reference internal" href="#ioevent">IOEvent</a> spec that</dt>
<dd>sets a collection of times/cycles at which the simulation is guaranteed to
hit exactly.  This is useful for situations such as where data is provided
at a regular interval, and interpolation error related to that data is to
be minimized.</dd>
</dl>
</li>
<li><cite>“PK tree</cite>” <code class="docutils literal notranslate"><span class="pre">[pk-type-spec-list]</span></code> List of length one, the top level PK spec.</li>
</ul>
<p>Note: Either <cite>“end cycle</cite>” or <cite>“end time</cite>” are required, and if
both are present, the simulation will stop with whichever arrives
first.  An <cite>“end cycle</cite>” is commonly used to ensure that, in the case
of a time step crash, we do not continue on forever spewing output.</p>
<p><code class="docutils literal notranslate"><span class="pre">[pk-type-spec]</span></code> is a pk type and a list of subpks.
* <cite>“PK type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of the registered PK types
* <cite>“sub PKs</cite>” <code class="docutils literal notranslate"><span class="pre">[pk-type-spec-list]</span></code> <strong>optional</strong> If there are sub pks, list them.</p>
<p>Example:</p>
</div>
<div class="section" id="visualization">
<h1><a class="toc-backref" href="#id22">Visualization</a><a class="headerlink" href="#visualization" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Manages simulation output to disk.</div></blockquote>
<p>A user may request periodic writes of field data for the purposes of
visualization in the <cite>“visualization</cite>” sublists.</p>
<p>ATS accepts a visualization list for each domain/mesh, including surface and
column meshes.  These are in separate ParameterLists, entitled
<cite>“visualization</cite>” for the main mesh, and <cite>“visualization surface</cite>” on the
surface mesh.  It is expected that, for any addition meshes, each will have a
domain name and therefore admit a spec of the form: <cite>“visualization
DOMAIN-NAME</cite>”.</p>
<p>Each list contains all parameters as in a <a class="reference internal" href="#ioevent">IOEvent</a> spec, and also:</p>
<ul class="simple">
<li><cite>“file name base</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>visdump_DOMAIN_data</strong></li>
<li><cite>“dynamic mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Write mesh data for every
visualization dump; this facilitates visualizing deforming meshes.</li>
<li><cite>“time units</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>s</strong> A valid time unit to convert time
into for output files.  One of <cite>“s</cite>”, <cite>“d</cite>”, <cite>“y</cite>”, or <cite>“yr 365</cite>”</li>
</ul>
<p>INCLUDES:
* <code class="docutils literal notranslate"><span class="pre">[io-event-spec]</span></code> An <a class="reference internal" href="#ioevent">IOEvent</a> spec</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;visualization&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file name base&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;visdump_data&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0, 100, -1}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{999, 1001}}&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 10.0, 100.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 25.0, -1.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{101.0, 303.0, 422.0}}&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;dynamic mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="checkpoint">
<h1><a class="toc-backref" href="#id23">Checkpoint</a><a class="headerlink" href="#checkpoint" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Manages checkpoint/restart capability.</div></blockquote>
<p>A user may request periodic dumps of ATS Checkpoint Data in the
<cite>“checkpoint</cite>” sublist.  The user has no explicit control over the
content of these files, but has the guarantee that the ATS run will be
reproducible (with accuracies determined by machine round errors and
randomness due to execution in a parallel computing environment).
Therefore, output controls for Checkpoint Data are limited to file
name generation and writing frequency, by numerical cycle number.
Unlike <cite>“visualization</cite>”, there is only one <cite>“checkpoint</cite>” list for
all domains/meshes.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>“file name base</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“checkpoint”</strong></li>
<li><cite>“file name digits</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>5</strong></li>
</ul>
<p>INCLUDES:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">[io-event-spec]</span></code> An <a class="reference internal" href="#ioevent">IOEvent</a> spec</p>
<p>Write mesh data for every visualization dump, this facilitates visualizing deforming meshes.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;checkpoint&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0, 100, -1}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{999, 1001}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 10.0, 100.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 25.0, -1.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{101.0, 303.0, 422.0}}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, checkpoint files are written when the cycle number is
a multiple of 100, every 10 seconds for the first 100 seconds, and
every 25 seconds thereafter, along with times 101, 303, and 422.  Files will be written in the form: <cite>“checkpoint00000.h5</cite>”.</p>
</div>
<div class="section" id="observation">
<h1><a class="toc-backref" href="#id24">Observation</a><a class="headerlink" href="#observation" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Observable: Collects, reduces, and writes observations during a simulation.</div></blockquote>
<p>Observations are a localized-in-space but frequent in time view of
data, designed to get at useful diagnostic quantities such as
hydrographs, total water content, quantities at a point, etc.  These
are designed to allow frequent collection in time without saving huge
numbers of visualization files to do postprocessing.  In fact, these
should be though of as orthogonal data queries to visualization – vis
is pointwise in time but complete in space, while observations are
pointwise/finite in space but complete in time.</p>
<p>A user may request any number of specific observations from ATS.  Each
observation spec involves a field quantity, a functional reduction
operator, a region from which it will extract its source data, and a
list of discrete times for its evaluation.  The observations are
evaluated during the simulation and written to disk.</p>
<p><code class="docutils literal notranslate"><span class="pre">[observation-spec]</span></code> consists of the following quantities:</p>
<ul class="simple">
<li><cite>“observation output filename</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> user-defined name for the file that the observations are written to.</li>
<li><cite>“variable</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> any ATS variable used by any PK, e.g. <cite>“pressure</cite>” or <cite>“surface-water_content</cite>”</li>
<li><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the label of a user-defined region</li>
<li><cite>“location name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the mesh location of the thing to be measured, i.e. <cite>“cell</cite>”, <cite>“face</cite>”, or <cite>“node</cite>”</li>
<li><cite>“functional</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the label of a function to apply to the variable across the region.  Valid functionals include:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><cite>“observation data: point</cite>” returns the value of the field quantity at a point.  The region and location name must result in a single entity being selected.</li>
<li><cite>“observation data: extensive integral</cite>” returns the sum of an (extensive) variable over the region.  This should be used for extensive quantities such as <cite>“water_content</cite>” or <cite>“energy</cite>”.</li>
<li><cite>“observation data: intensive integral</cite>” returns the volume-weighted average of an (intensive) variable over the region.  This should be used for intensive quantities such as <cite>“temperature</cite>” or <cite>“saturation_liquid</cite>”.</li>
</ul>
</div></blockquote>
<p>For flux observations, additional options are available:</p>
<ul class="simple">
<li><cite>“direction normalized flux</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>optional</strong> Dots the face-normal flux with a vector to ensure fluxes are integrated pointing the same direction.</li>
<li><cite>“direction normalized flux direction</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> <strong>optional</strong>
Provides the vector to dot the face normal with.  If this is not provided,
then it is assumed that the faces integrated over are all boundary faces and
that the default vector is the outward normal direction for each face.</li>
</ul>
<p>Additionally, each <code class="docutils literal notranslate"><span class="pre">[observation-spec]</span></code> contains all parameters as in a <a class="reference internal" href="#ioevent">IOEvent</a> spec, which are used to specify at which times/cycles the observation is collected.</p>
<p>INCLUDES:
* <code class="docutils literal notranslate"><span class="pre">[io-event-spec]</span></code> An <a class="reference internal" href="#ioevent">IOEvent</a> spec</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;observations&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- This measures the hydrograph out the &quot;east&quot; face of the surface domain --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;surface outlet flux&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface-mass_flux&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;direction normalized flux&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;east&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: extensive integral&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;face&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface_outlet_flux.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="c">&lt;!-- This measures the total water, in mols, in the entire subsurface domain --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;subsurface water content&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;water_content&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;computational domain&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: extensive integral&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;water_content.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="c">&lt;!-- This tracks the temperature at a point --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;temperature_probeA&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;temperature&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;probeA&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: point&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;temperature_probeA.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="pk">
<h1><a class="toc-backref" href="#id25">PK</a><a class="headerlink" href="#pk" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>The interface for a Process Kernel, an equation or system of equations.</div></blockquote>
<p>A process kernel represents a single or system of partial/ordinary
differential equation(s) or conservation law(s), and is used as the
fundamental unit for coupling strategies.</p>
<p>Implementations of this interface typically are either an MPC
(multi-process coupler) whose job is to heirarchically couple several
other PKs and represent the system of equations, or a Physical PK,
which represents a single equation.</p>
<p>All PKs have the following parameters in their spec:</p>
<ul>
<li><p class="first"><cite>“PK type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code></p>
<p>The PK type is a special key-word which corresponds to a given class in the PK factory.  See available PK types listed below.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;my cool PK&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;PK type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my cool PK&quot;</span><span class="nt">/&gt;</span>
     ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Top level MPC&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;PK type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;strong MPC&quot;</span><span class="nt">/&gt;</span>
     ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="base-pks">
<h2><a class="toc-backref" href="#id26">Base PKs</a><a class="headerlink" href="#base-pks" title="Permalink to this headline">¶</a></h2>
<p>There are several types of PKs, and each PK has its own valid input spec.  However, there are three main types of PKs, from which nearly all PKs derive.  Note that none of these are true PKs and cannot stand alone.</p>
<div class="section" id="pkphysicalbase">
<h3><a class="toc-backref" href="#id27">PKPhysicalBase</a><a class="headerlink" href="#pkphysicalbase" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>A base class with default implementations of methods for a leaf of the PK tree (a conservation equation, or similar).</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">PKPhysicalBase</span></code> is a base class providing some functionality for PKs which
are defined on a single mesh, and represent a single process model.  Typically
all leaves of the PK tree will inherit from <code class="docutils literal notranslate"><span class="pre">PKPhysicalBase</span></code>.</p>
<ul>
<li><p class="first"><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> e.g. <cite>“surface</cite>”.</p>
<p>Domains and meshes are 1-to-1, and the empty string refers to the main domain or mesh.  PKs defined on other domains must specify which domain/mesh they refer to.</p>
</li>
<li><p class="first"><cite>“primary variable key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Sets the primary variable.</p>
<p>The primary variable associated with this PK, i.e. <cite>“pressure</cite>”, <cite>“temperature</cite>”, <cite>“surface_pressure</cite>”, etc.</p>
</li>
<li><p class="first"><cite>“initial condition</cite>” <code class="docutils literal notranslate"><span class="pre">[initial-conditions-spec]</span></code>  See <a class="reference internal" href="#initialconditions">InitialConditions</a>.</p>
<blockquote>
<div><p>Indicates that the primary variable field has both CELL and FACE objects, and the FACE values are calculated as the average of the neighboring cells.</p>
</div></blockquote>
</li>
</ul>
<p>NOTE: <code class="docutils literal notranslate"><span class="pre">PKPhysicalBase</span> <span class="pre">(v)--&gt;</span></code> <a href="#id136"><span class="problematic" id="id137">PKDefaultBase_</span></a></p>
</div>
<div class="section" id="pkbdfbase">
<h3><a class="toc-backref" href="#id28">PKBDFBase</a><a class="headerlink" href="#pkbdfbase" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>A base class with default implementations of methods for a PK that can be implicitly integrated in time.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">PKBDFBase</span></code> is a base class from which PKs that want to use the <code class="docutils literal notranslate"><span class="pre">BDF</span></code>
series of implicit time integrators must derive.  It specifies both the
<code class="docutils literal notranslate"><span class="pre">BDFFnBase</span></code> interface and implements some basic functionality for <code class="docutils literal notranslate"><span class="pre">BDF</span></code>
PKs.</p>
<ul>
<li><p class="first"><cite>“initial time step</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.</strong></p>
<p>The initial timestep size for the PK, this ensures that the initial timestep
will not be <strong>larger</strong> than this value.</p>
</li>
<li><p class="first"><cite>“assemble preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>true</strong></p>
<p>A flag for the PK to not assemble its preconditioner if it is not needed by
a controlling PK.  This is usually set by the MPC, not by the user.</p>
</li>
</ul>
<p>In the top-most (in the PK tree) PK that is meant to be integrated implicitly,
several additional specs are included.  For instance, in a strongly coupled
flow and energy problem, these specs are included in the <code class="docutils literal notranslate"><span class="pre">StrongMPC</span></code> that
couples the flow and energy PKs, not to the flow or energy PK itself.</p>
<ul>
<li><p class="first"><cite>“time integrator</cite>” <code class="docutils literal notranslate"><span class="pre">[implicit-time-integrator-typed-spec]</span></code> <strong>optional</strong>
A <a class="reference internal" href="#timeintegrator">TimeIntegrator</a>.  Note that this is only provided if this PK is not
strongly coupled to other PKs.</p>
</li>
<li><p class="first"><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[preconditioner-typed-spec]</span></code> <strong>optional</strong> is a <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</p>
<p>This spec describes how to form the (approximate) inverse of the preconditioner.</p>
</li>
</ul>
<p>NOTE: <code class="docutils literal notranslate"><span class="pre">PKBDFBase</span>&#160; <span class="pre">(v)--&gt;</span></code> <a href="#id138"><span class="problematic" id="id139">PKDefaultBase_</span></a></p>
</div>
<div class="section" id="pkphysicalbdfbase">
<h3><a class="toc-backref" href="#id29">PKPhysicalBDFBase</a><a class="headerlink" href="#pkphysicalbdfbase" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Standard base for most implemented PKs, this combines both domains/meshes of PKPhysicalBase and BDF methods of PKBDFBase.</div></blockquote>
<p>A base class for all PKs that are both physical, in the sense that they
implement an equation and are not couplers, and support the implicit
integration interface.  This largely just supplies a default error norm based
on error in conservation relative to the extent of the conserved quantity.</p>
<ul class="simple">
<li><cite>“absolute error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> Absolute tolerance,
<span class="math notranslate nohighlight">\(a_tol\)</span> in the equation below.  Note that this default is often
overridden by PKs with more physical values, and very rarely are these set
by the user.</li>
<li><cite>“relative error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> Relative tolerance,
<span class="math notranslate nohighlight">\(r_tol\)</span> in the equation below.  Note that this default is often
overridden by PKs with more physical values, and very rarely are these set
by the user.</li>
<li><cite>“flux error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> Relative tolerance on the
flux.  Note that this default is often overridden by PKs with more physical
values, and very rarely are these set by the user.</li>
</ul>
<p>By default, the error norm used by solvers is given by:</p>
<p><span class="math notranslate nohighlight">\(ENORM(u, du) = |du| / ( a_tol + r_tol * |u| )\)</span></p>
<p>The defaults here are typically good, or else good defaults are set in the
code, so these need not be supplied.</p>
<dl class="docutils">
<dt>NOTE: <code class="docutils literal notranslate"><span class="pre">PKPhysicalBDFBase</span> <span class="pre">--&gt;</span></code> <a class="reference internal" href="#pkbdfbase">PKBDFBase</a></dt>
<dd><code class="docutils literal notranslate"><span class="pre">PKPhysicalBDFBase</span> <span class="pre">--&gt;</span></code> <a class="reference internal" href="#pkphysicalbase">PKPhysicalBase</a>
<code class="docutils literal notranslate"><span class="pre">PKPhysicalBDFBase</span> <span class="pre">(v)--&gt;</span></code> <a href="#id140"><span class="problematic" id="id141">PKDefaultBase_</span></a></dd>
</dl>
</div>
</div>
<div class="section" id="physical-pks">
<h2><a class="toc-backref" href="#id30">Physical PKs</a><a class="headerlink" href="#physical-pks" title="Permalink to this headline">¶</a></h2>
<p>Physical PKs are the physical capability implemented within ATS.</p>
<div class="section" id="flow-pks">
<h3><a class="toc-backref" href="#id31">Flow PKs</a><a class="headerlink" href="#flow-pks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="richards-pk">
<h4><a class="toc-backref" href="#id32">Richards PK</a><a class="headerlink" href="#richards-pk" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Two-phase, variable density Richards equation.</div></blockquote>
<p>Solves Richards equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \Theta}{\partial t} - \nabla \frac{k_r n_l}{\mu} K ( \nabla p + \rho g \cdot \hat{z} ) = Q_w\]</div>
<p>Includes options from:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">[pk-physical-default-spec]</span></code> <a href="#id142"><span class="problematic" id="id143">PKPhysicalDefault_</span></a></li>
</ul>
<p># <code class="docutils literal notranslate"><span class="pre">[pk-bdf-default-spec]</span></code> <a href="#id144"><span class="problematic" id="id145">PKBDFDefault_</span></a>
* <code class="docutils literal notranslate"><span class="pre">[pk-physical-bdf-default-spec]</span></code> <a href="#id146"><span class="problematic" id="id147">PKPhysicalBDFDefault_</span></a></p>
<p>Other variable names, typically not set as the default is basically always good:</p>
<ul class="simple">
<li><cite>“conserved quantity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-water_content</strong> Typically not set, default is good. <code class="docutils literal notranslate"><span class="pre">[mol]</span></code></li>
<li><cite>“mass density key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-mass_density_liquid</strong> liquid water density <code class="docutils literal notranslate"><span class="pre">[kg</span> <span class="pre">m^-3]</span></code></li>
<li><cite>“molar density key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-molar_density_liquid</strong> liquid water density <code class="docutils literal notranslate"><span class="pre">[mol</span> <span class="pre">m^-3]</span></code></li>
<li><cite>“permeability key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-permeability</strong> permeability of the soil medium <code class="docutils literal notranslate"><span class="pre">[m^2]</span></code></li>
<li><cite>“conductivity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-relative_permeability</strong> scalar coefficient of the permeability <code class="docutils literal notranslate"><span class="pre">[-]</span></code></li>
<li><cite>“upwind conductivity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-upwind_relative_permeability</strong> upwinded (face-based) scalar coefficient of the permeability.  Note the units of this are strange, but this represents <span class="math notranslate nohighlight">\(\frac{n_l k_r}{\mu}\)</span>  <code class="docutils literal notranslate"><span class="pre">[mol</span> <span class="pre">kg^-1</span> <span class="pre">s^1</span> <span class="pre">m^-2]</span></code></li>
<li><cite>“darcy flux key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-mass_flux</strong> mass flux across a face <code class="docutils literal notranslate"><span class="pre">[mol</span> <span class="pre">s^-1]</span></code></li>
<li><cite>“darcy flux direction key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-mass_flux_direction</strong> direction of the darcy flux (used in upwinding <span class="math notranslate nohighlight">\(k_r\)</span>) <code class="docutils literal notranslate"><span class="pre">[??]</span></code></li>
<li><cite>“darcy velocity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-darcy_velocity</strong> darcy velocity vector, interpolated from faces to cells <code class="docutils literal notranslate"><span class="pre">[m</span> <span class="pre">s^-1]</span></code></li>
<li><cite>“darcy flux key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-mass_flux</strong> mass flux across a face <code class="docutils literal notranslate"><span class="pre">[mol</span> <span class="pre">s^-1]</span></code></li>
<li><cite>“saturation key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-saturation_liquid</strong> volume fraction of the liquid phase <code class="docutils literal notranslate"><span class="pre">[-]</span></code></li>
</ul>
<p>Discretization control:</p>
<ul class="simple">
<li><cite>“diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> An <a href="#id148"><span class="problematic" id="id149">PDE_Diffusion_</span></a> spec describing the (forward) diffusion operator</li>
<li><cite>“diffusion preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> An <a href="#id150"><span class="problematic" id="id151">PDE_Diffusion_</span></a> spec describing the diffusive parts of the preconditioner.</li>
<li><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[linear-solver-typed-spec]</span></code> <strong>optional</strong> is a <a href="#id152"><span class="problematic" id="id153">LinearSolver_</span></a> spec.  Note
that this is only used if this PK is not strongly coupled to other PKs.</li>
</ul>
<p>Boundary conditions:</p>
<p>//* <cite>“boundary conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[subsurface-flow-bc-spec]</span></code> Defaults to Neuman, 0 normal flux.  See <a class="reference internal" href="#flow-specific-boundary-conditions">Flow-specific Boundary Conditions</a></p>
<p>Physics control:</p>
<ul class="simple">
<li><cite>“permeability rescaling</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong> Typically 1e7 or order <span class="math notranslate nohighlight">\(sqrt(K)\)</span> is about right.  This rescales things to stop from multiplying by small numbers (permeability) and then by large number (<span class="math notranslate nohighlight">\(\rho / \mu\)</span>).</li>
<li><cite>“permeability type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>‘scalar’</strong> The permeability type can be ‘scalar’, ‘horizontal and vertical’, ‘diagonal tensor’, or ‘full tensor’. This key is placed in state-&gt;field evaluators-&gt;permeability. The ‘scalar’ option requires 1 permeability value, ‘horizontal and vertical’ requires 2 values, ‘diagonal tensor’ requires 2 (2D) or 3 (3D) values, and ‘full tensor’ requires 3 (2D) or 6 (3D) values. The ordering of the permeability values in the input script is important: ‘horizontal and vertical’={xx/yy,zz}, ‘diagonal tensor’={xx,yy} or {xx,yy,zz}, ‘full tensor’={xx,yy,xy/yx} or {xx,yy,zz,xy/yx,xz/zx,yz/zy}.</li>
<li><cite>“water retention evaluator</cite>” <code class="docutils literal notranslate"><span class="pre">[wrm-evaluator-spec]</span></code> The WRM.  This needs to go away!</li>
</ul>
<p>This PK additionally requires the following:</p>
<p>EVALUATORS:
- <cite>“conserved quantity</cite>”
- <cite>“mass density</cite>”
- <cite>“molar density</cite>”
- <cite>“permeability</cite>”
- <cite>“conductivity</cite>”
- <cite>“saturation</cite>”</p>
</div>
<div class="section" id="permafrost-flow-pk">
<h4><a class="toc-backref" href="#id33">Permafrost Flow PK</a><a class="headerlink" href="#permafrost-flow-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="overland-flow-head-primary-variable-pk">
<h4><a class="toc-backref" href="#id34">Overland Flow, head primary variable PK</a><a class="headerlink" href="#overland-flow-head-primary-variable-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="overland-flow-pressure-primary-variable-pk">
<h4><a class="toc-backref" href="#id35">Overland Flow, pressure primary variable, PK</a><a class="headerlink" href="#overland-flow-pressure-primary-variable-pk" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Overland flow using the diffusion wave equation.</div></blockquote>
<p>Solves the diffusion wave equation for overland flow with pressure as a primary variable:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \Theta}{\partial t} - \nabla n_l k \nabla h(p) = Q_w\]</div>
<p>Options:</p>
<p>Variable naming:</p>
<ul class="simple">
<li><cite>“domain</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“surface”</strong>  Defaults to the extracted surface mesh.</li>
<li><cite>“primary variable</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> The primary variable associated with this PK, typically <cite>“DOMAIN-pressure</cite>”</li>
</ul>
<p>Other variable names, typically not set as the default is basically always good:</p>
<ul class="simple">
<li><cite>“conserved quantity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“DOMAIN-water_content”</strong> The conserved quantity name.</li>
</ul>
<p>Discretization control:</p>
<ul class="simple">
<li><cite>“diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> An <a href="#id154"><span class="problematic" id="id155">PDE_Diffusion_</span></a> spec describing the (forward) diffusion operator</li>
<li><cite>“diffusion preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> An <a href="#id156"><span class="problematic" id="id157">PDE_Diffusion_</span></a> spec describing the diffusive parts of the preconditioner.</li>
</ul>
<p>Time integration and timestep control:</p>
<ul class="simple">
<li><cite>“initial time step</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.</strong> Max initial time step size <code class="docutils literal notranslate"><span class="pre">[s]</span></code>.</li>
<li><cite>“time integrator</cite>” <code class="docutils literal notranslate"><span class="pre">[implicit-time-integrator-typed-spec]</span></code> <strong>optional</strong> is a <a class="reference internal" href="#timeintegrator">TimeIntegrator</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[linear-solver-typed-spec]</span></code> <strong>optional</strong> is a <a href="#id158"><span class="problematic" id="id159">LinearSolver_</span></a> spec.  Note
that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[preconditioner-typed-spec]</span></code> <strong>optional</strong> is a <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>“initial condition</cite>” <code class="docutils literal notranslate"><span class="pre">[initial-conditions-spec]</span></code> See <a class="reference internal" href="#initialconditions">InitialConditions</a>.</li>
</ul>
<p>Error control:</p>
<ul class="simple">
<li><cite>“absolute error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>550.</strong> Defaults to 1 cm of water.  A small, but significant, amount of water.</li>
<li><cite>“relative error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong> Take the error relative to the amount of water present in that cell.</li>
<li><cite>“flux tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong> Multiplies the error in flux (on a face)
relative to the min of water in the neighboring cells.  Typically only
changed if infiltration is very small and the boundary condition is not
converging, at which point it can be decreased by an order of magnitude at a
time until the boundary condition is satisfied.</li>
</ul>
<p>Boundary conditions:</p>
<p>xx* <cite>“boundary conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[surface-flow-bc-spec]</span></code> Defaults to Neuman, 0 normal flux.</p>
<p>May inherit options from <a class="reference internal" href="#pkphysicalbdfbase">PKPhysicalBDFBase</a>.</p>
</div>
<div class="section" id="snow-distribution-pk">
<h4><a class="toc-backref" href="#id36">Snow Distribution PK</a><a class="headerlink" href="#snow-distribution-pk" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="energy-pks">
<h3><a class="toc-backref" href="#id37">Energy PKs</a><a class="headerlink" href="#energy-pks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="advection-diffusion-pk">
<h4><a class="toc-backref" href="#id38">Advection Diffusion PK</a><a class="headerlink" href="#advection-diffusion-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="energy-base-pk">
<h4><a class="toc-backref" href="#id39">Energy Base PK</a><a class="headerlink" href="#energy-base-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="two-phase-subsurface-energy-pk">
<h4><a class="toc-backref" href="#id40">Two-Phase subsurface Energy PK</a><a class="headerlink" href="#two-phase-subsurface-energy-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="three-phase-subsurface-energy-pk">
<h4><a class="toc-backref" href="#id41">Three-Phase subsurface Energy PK</a><a class="headerlink" href="#three-phase-subsurface-energy-pk" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="id1">
<h4><a class="toc-backref" href="#id42">Three-Phase subsurface Energy PK</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="surface-ice-energy-pk">
<h4><a class="toc-backref" href="#id43">Surface Ice Energy PK</a><a class="headerlink" href="#surface-ice-energy-pk" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="surface-energy-balance-pks">
<h3><a class="toc-backref" href="#id44">Surface Energy Balance PKs</a><a class="headerlink" href="#surface-energy-balance-pks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="surface-energy-balance-snow-monolithic-version">
<h4><a class="toc-backref" href="#id45">Surface Energy Balance / Snow – Monolithic Version</a><a class="headerlink" href="#surface-energy-balance-snow-monolithic-version" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="surface-energy-balance-generic-version">
<h4><a class="toc-backref" href="#id46">Surface Energy Balance – Generic Version</a><a class="headerlink" href="#surface-energy-balance-generic-version" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="biogeochemistry">
<h3><a class="toc-backref" href="#id47">Biogeochemistry</a><a class="headerlink" href="#biogeochemistry" title="Permalink to this headline">¶</a></h3>
<div class="section" id="biogeochemistry-monolithic-version">
<h4><a class="toc-backref" href="#id48">Biogeochemistry – Monolithic Version</a><a class="headerlink" href="#biogeochemistry-monolithic-version" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="deformation">
<h3><a class="toc-backref" href="#id49">Deformation</a><a class="headerlink" href="#deformation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="volumetric-deformation">
<h4><a class="toc-backref" href="#id50">Volumetric Deformation</a><a class="headerlink" href="#volumetric-deformation" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="mpcs">
<h2><a class="toc-backref" href="#id51">MPCs</a><a class="headerlink" href="#mpcs" title="Permalink to this headline">¶</a></h2>
<p>MPCs couple other PKs, and are the non-leaf nodes in the PK tree.</p>
<div class="section" id="weakmpc">
<h3><a class="toc-backref" href="#id52">WeakMPC</a><a class="headerlink" href="#weakmpc" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="strongmpc">
<h3><a class="toc-backref" href="#id53">StrongMPC</a><a class="headerlink" href="#strongmpc" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="physical-mpcs">
<h2><a class="toc-backref" href="#id54">Physical MPCs</a><a class="headerlink" href="#physical-mpcs" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>coupling is an art, and requires special off-diagonal work.  Physical MPCs can derive from default MPCs to provide special work.</div></blockquote>
<div class="section" id="coupled-water-mpc">
<h3><a class="toc-backref" href="#id55">Coupled Water MPC</a><a class="headerlink" href="#coupled-water-mpc" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>MPCCoupledWater: coupler which integrates surface and subsurface flow.</div></blockquote>
<p>Couples Richards equation to surface water through continuity of both pressure and fluxes.</p>
<p>Currently requires that the subsurface discretization is a face-based
discretization, i.e. one of the MFD methods.  Then the surface equations are
directly added into the subsurface discrete equations.</p>
<ul class="simple">
<li><cite>“PKs order</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> Supplies the names of the coupled PKs.
The order must be {subsurface_flow_pk, surface_flow_pk} (subsurface first).</li>
<li><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[linear-solver-typed-spec]</span></code> <strong>optional</strong> is a <a href="#id160"><span class="problematic" id="id161">LinearSolver_</span></a> spec.  Note
that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[preconditioner-typed-spec]</span></code> <strong>optional</strong> is a <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>“water delegate</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></li>
</ul>
<blockquote>
<div><p>Globalization hacks to deal with nonlinearity around the appearance/disappearance of surface water.</p>
<p>The water delegate works to eliminate discontinuities/strong nonlinearities
when surface cells shift from dry to wet (i.e. the surface pressure goes
from &lt; atmospheric pressure to &gt; atmospheric pressure.</p>
<p>These methods work to alter the predictor around this nonlinearity.</p>
<ul class="simple">
<li><cite>“modify predictor with heuristic</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> This simply
limits the prediction to backtrack to just above atmospheric on both the
first and second timesteps that take us over atmospheric.</li>
<li><cite>“modify predictor damp and cap the water spurt</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> The
second both limits (caps) and damps all surface cells to ensure that all
nearby cells are also not overshooting.  This is the preferred method.</li>
</ul>
<p>These methods work to alter the preconditioned correction for the same
reasons described above.</p>
<ul class="simple">
<li><cite>“global water face limiter</cite>” <code class="docutils literal notranslate"><span class="pre">[default]</span></code> <strong>INF</strong> This is simply a limit
to the maximum allowed size of the correction (in [Pa]) on all faces.  Any
correction larger than this is set to this.</li>
<li><cite>“cap the water spurt</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> If a correction takes the
pressure on a surface cell from below atmospheric (dry) to above (wet),
the correction is set to a value which results in the new iterate to being
CAP_SIZE over atmospheric.</li>
<li><cite>“damp the water spurt</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> A damping factor (less than
one) is calculated to multiply the correction such that the largest
correction takes a cell to just above atmospheric.  All faces (globally)
are affected.</li>
<li><cite>“damp and cap the water spurt</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> None of the above
should really be used.  Capping, when the cap is particularly severe,
results in faces whose values are very out of equilibrium with their
neighboring cells which are not capped.  Damping results in a tiny
timestep in which, globally, at MOST one face can go from wet to dry.
This looks to do a combination, in which all things are damped, but faces
that are initially expected to go from dry to wet are pre-scaled to ensure
that, when damped, they are also (like the biggest change) allowed to go
from dry to wet (so that multiple cells can wet in the same step).  This
is the preferred method.</li>
</ul>
<p>In these methods, the following parameters are useful:</p>
<ul class="simple">
<li><cite>“cap over atmospheric</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>100 Pa</strong> This sets the max size over
atmospheric to which things are capped or damped.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="subsurface-mpc">
<h3><a class="toc-backref" href="#id56">Subsurface MPC</a><a class="headerlink" href="#subsurface-mpc" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="permafrost-mpc">
<h3><a class="toc-backref" href="#id57">Permafrost MPC</a><a class="headerlink" href="#permafrost-mpc" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>
<div class="section" id="state">
<h1><a class="toc-backref" href="#id58">State</a><a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h1>
<p>State consists of two sublists, one for evaluators and the other for
atomic constants.  The latter is currently called <cite>“initial
conditions</cite>”, which is a terrible name which must be fixed.</p>
<p>example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;field evaluators&quot;</span><span class="nt">&gt;</span>
    ...
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
    ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="field-evaluators">
<h2><a class="toc-backref" href="#id59">Field Evaluators</a><a class="headerlink" href="#field-evaluators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="primaryvariableevaluator">
<h3><a class="toc-backref" href="#id60">PrimaryVariableEvaluator</a><a class="headerlink" href="#primaryvariableevaluator" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="independentvariableevaluator">
<h3><a class="toc-backref" href="#id61">IndependentVariableEvaluator</a><a class="headerlink" href="#independentvariableevaluator" title="Permalink to this headline">¶</a></h3>
<p>Independent variables are provided either by a function or directly loaded from a file.</p>
<div class="section" id="from-function">
<h4><a class="toc-backref" href="#id62">From Function</a><a class="headerlink" href="#from-function" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="from-file">
<h4><a class="toc-backref" href="#id63">From File</a><a class="headerlink" href="#from-file" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="water-content">
<h3><a class="toc-backref" href="#id64">Water Content</a><a class="headerlink" href="#water-content" title="Permalink to this headline">¶</a></h3>
<p>Water content is the conserved quantity in most flow equations, including
Richard’s equation with and without ice.  A variety of evaluators are provided
for inclusion of multiple phases.</p>
<div class="section" id="richards-equation-water-content">
<h4><a class="toc-backref" href="#id65">Richards Equation water content</a><a class="headerlink" href="#richards-equation-water-content" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>The Richards water content evaluator is an algebraic evaluator for liquid only water content</dt>
<dd>Generated via evaluator_generator with:</dd>
</dl>
</div></blockquote>
<p>Richards water content evaluator: the standard form as a function of liquid saturation.</p>
<div class="math notranslate nohighlight">
\[Theta = n * s * phi * cell volume\]</div>
<p><code class="docutils literal notranslate"><span class="pre">[field-evaluator-type-richards-water-content-spec]</span></code></p>
<ul class="simple">
<li><cite>“porosity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-porosity</strong></li>
<li><cite>“molar density liquid key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-molar_density_liquid</strong></li>
<li><cite>“saturation liquid key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-saturation_liquid</strong></li>
<li><cite>“cell volume key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-cell_volume</strong></li>
</ul>
<p>EVALUATORS:
- <cite>“porosity</cite>”
- <cite>“molar density liquid</cite>”
- <cite>“saturation liquid</cite>”
- <cite>“cell volume</cite>”</p>
</div>
<div class="section" id="liquid-gas-water-content">
<h4><a class="toc-backref" href="#id66">Liquid+Gas water content</a><a class="headerlink" href="#liquid-gas-water-content" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="liquid-ice-water-content">
<h4><a class="toc-backref" href="#id67">Liquid+Ice water content</a><a class="headerlink" href="#liquid-ice-water-content" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="liquid-ice-gas-water-content">
<h4><a class="toc-backref" href="#id68">Liquid+Ice+Gas water content</a><a class="headerlink" href="#liquid-ice-gas-water-content" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Three phase water content: vapor, liquid, and ice.</div></blockquote>
<div class="math notranslate nohighlight">
\[Theta = (n_l * s_l + n_i * s_i + n_g * s_g * \omega_g ) * \phi * |E|\]</div>
<ul class="simple">
<li><cite>“porosity key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-porosity</strong></li>
<li><cite>“molar density liquid key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-molar_density_liquid</strong></li>
<li><cite>“saturation liquid key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-saturation_liquid</strong></li>
<li><cite>“molar density ice key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-molar_density_ice</strong></li>
<li><cite>“saturation ice key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-saturation_ice</strong></li>
<li><cite>“molar density gas key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-molar_density_gas</strong></li>
<li><cite>“saturation gas key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-saturation_gas</strong></li>
<li><cite>“mol frac gas key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-mol_frac_gas</strong> The molar fraction of water vapor in the gaseous phase.</li>
<li><cite>“cell volume key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-cell_volume</strong></li>
</ul>
<p>EVALUATORS:
- <cite>“porosity</cite>”
- <cite>“molar density liquid</cite>”
- <cite>“saturation liquid</cite>”
- <cite>“molar density ice</cite>”
- <cite>“saturation ice</cite>”
- <cite>“molar density gas</cite>”
- <cite>“saturation gas</cite>”
- <cite>“molar fraction gas</cite>”
- <cite>“cell volume</cite>”</p>
</div>
</div>
<div class="section" id="surface-water-potential-surfaces">
<h3><a class="toc-backref" href="#id69">Surface Water potential surfaces</a><a class="headerlink" href="#surface-water-potential-surfaces" title="Permalink to this headline">¶</a></h3>
<p>Evaluators for</p>
<div class="section" id="surfaceelevation">
<h4><a class="toc-backref" href="#id70">SurfaceElevation</a><a class="headerlink" href="#surfaceelevation" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>MeshedElevationEvaluator: evaluates the elevation (z-coordinate) and slope magnitude of a mesh.</div></blockquote>
<p>Evaluator type: <cite>“meshed elevation</cite>”</p>
<p>Evaluates the z-coordinate and the magnitude of the slope :math:<code class="docutils literal notranslate"><span class="pre">|\nambla_h</span> <span class="pre">z|</span></code></p>
<ul class="simple">
<li><cite>“elevation key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>elevation</strong> Name the elevation variable. [m]</li>
<li><cite>“slope magnitude key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>slope_magnitude</strong> Name the elevation variable. [-]</li>
<li><cite>“dynamic mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Lets the evaluator know that the elevation changes in time, and adds the <cite>“deformation</cite>” dependency.</li>
<li><cite>“parent domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN</strong> Domain name of the parent mesh, which is the 3D version of this domain.  Attempts to generate an intelligent default by stripping “surface” from this domain.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;elevation&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;meshed elevation&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="surfacepotential">
<h4><a class="toc-backref" href="#id71">SurfacePotential</a><a class="headerlink" href="#surfacepotential" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>PresElevEvaluator: evaluates h + z</div></blockquote>
<p>Evaluator type: “”</p>
<div class="math notranslate nohighlight">
\[h + z\]</div>
<ul class="simple">
<li><cite>“my key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>pres_elev</strong> Names the surface water potential variable, h + z [m]</li>
<li><cite>“height key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>ponded_depth</strong> Names the height variable. [m]</li>
<li><cite>“elevation key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>elevation</strong> Names the elevation variable. [m]</li>
</ul>
<p>NOTE: This is a legacy evaluator, and is not in the factory, so need not be in
the input spec.  However, we include it here because this could easily be
abstracted for new potential surfaces, kinematic wave, etc, at which point it
would need to be added to the factory and the input spec.</p>
<p>NOTE: This could easily be replaced by a generic <a href="#id162"><span class="problematic" id="id163">AdditiveEvaluator_</span></a></p>
</div>
<div class="section" id="snowsurfacepotential">
<h4><a class="toc-backref" href="#id72">SnowSurfacePotential</a><a class="headerlink" href="#snowsurfacepotential" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>PresElevEvaluator: evaluates h + z</div></blockquote>
<p>Evaluator type: “snow skin potential”</p>
<div class="math notranslate nohighlight">
\[h + z + h_{{snow}} + dt * P_{{snow}}\]</div>
<ul class="simple">
<li><cite>“my key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>snow_skin_potential</strong> Names the potential variable evaluated [m]</li>
<li><cite>“ponded depth key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>ponded_depth</strong> Names the surface water depth variable. [m]</li>
<li><cite>“snow depth key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>snow_depth</strong> Names the snow depth variable. [m]</li>
<li><cite>“precipitation snow key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>precipitation_snow</strong> Names the snow precipitation key. [m]</li>
<li><cite>“elevation key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>elevation</strong> Names the elevation variable. [m]</li>
<li><cite>“dt factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> A free-parameter factor for providing a time scale for diffusion of snow precipitation into low-lying areas.  Typically on the order of 1e4-1e7. This timestep times the wave speed of snow provides an approximate length of how far snow precip can travel.  Extremely tunable! [s]</li>
</ul>
<p>NOTE: This is equivalent to a generic <a href="#id164"><span class="problematic" id="id165">AdditiveEvaluator_</span></a></p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;snow_skin_potential&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;snow skin potential&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;dt factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;864000.0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="surface-water-content">
<h4><a class="toc-backref" href="#id73">Surface water content</a><a class="headerlink" href="#surface-water-content" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="generic-evaluators">
<h3><a class="toc-backref" href="#id74">Generic Evaluators</a><a class="headerlink" href="#generic-evaluators" title="Permalink to this headline">¶</a></h3>
<p>Several generic evaluators are provided.</p>
<div class="section" id="additive">
<h4><a class="toc-backref" href="#id75">Additive</a><a class="headerlink" href="#additive" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="multiplicative">
<h4><a class="toc-backref" href="#id76">Multiplicative</a><a class="headerlink" href="#multiplicative" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="column-summation">
<h4><a class="toc-backref" href="#id77">Column summation</a><a class="headerlink" href="#column-summation" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="subgrid-disaggregation">
<h4><a class="toc-backref" href="#id78">Subgrid disaggregation</a><a class="headerlink" href="#subgrid-disaggregation" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>SubgridDisaggregateEvaluator restricts a field to the subgrid version of the same field.</p>
<ul class="simple">
<li><cite>“source domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Domain name of the source mesh.</li>
</ul>
</div></blockquote>
<p>ONE OF:
* <cite>“field key suffix</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>FIELD_SUFFIX from this</strong> Set the suffix of the variable
OR
* <cite>“field key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>DOMAIN-FIELD_SUFFIX</strong></p>
</div>
</div>
</div>
<div class="section" id="initialconditions">
<h2><a class="toc-backref" href="#id79">InitialConditions</a><a class="headerlink" href="#initialconditions" title="Permalink to this headline">¶</a></h2>
<p>Initial condition specs are used in two places:</p>
<ul class="simple">
<li>within the <a class="reference internal" href="#pk">PK</a> spec which describes the initial condition of primary variables (true
initial conditions), and</li>
<li>in the <cite>“initial conditions</cite>” sublist of state, in which the value
of atomic constants are provided (not really initial conditions and
should be renamed).  These atomic values are not controlled by
evaluators, and are not included in the DaG.  Likely these should be
removed entirely.</li>
</ul>
<div class="section" id="initialization-of-constant-scalars">
<h3><a class="toc-backref" href="#id80">Initialization of constant scalars</a><a class="headerlink" href="#initialization-of-constant-scalars" title="Permalink to this headline">¶</a></h3>
<p>A constant scalar field is the global (with respect to the mesh)
constant.  At the moment, the set of such fields includes atmospheric
pressure.  The initialization requires to provide a named sublist with
a single parameter <cite>“value</cite>”.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="initialization-of-constant-vectors">
<h3><a class="toc-backref" href="#id81">Initialization of constant vectors</a><a class="headerlink" href="#initialization-of-constant-vectors" title="Permalink to this headline">¶</a></h3>
<p>A constant vector field is the global (with respect to the mesh)
vector constant.  At the moment, the set of such vector constants
includes gravity.  The initialization requires to provide a named
sublist with a single parameter <cite>“Array(double)</cite>”. In two dimensions,
is looks like</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="initialization-of-scalar-fields">
<h3><a class="toc-backref" href="#id82">Initialization of scalar fields</a><a class="headerlink" href="#initialization-of-scalar-fields" title="Permalink to this headline">¶</a></h3>
<p>A variable scalar field is defined by a few functions (labeled for instance,
<cite>“Mesh Block i</cite>” with non-overlapping ranges.
The required parameters for each function are <cite>“region</cite>”, <cite>“component</cite>”,
and the function itself.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Mesh Block 1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Computational domain&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;component&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Mesh Block 2&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="initialization-of-tensor-fields">
<h3><a class="toc-backref" href="#id83">Initialization of tensor fields</a><a class="headerlink" href="#initialization-of-tensor-fields" title="Permalink to this headline">¶</a></h3>
<p>A variable tensor (or vector) field is defined similarly to a variable
scalar field.  The difference lies in the definition of the function
which is now a multi-values function.  The required parameters are
<cite>“Number of DoFs</cite>” and <cite>“Function type</cite>”.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Number of DoFs&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Function type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DoF 1 Function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.9976e-12&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DoF 2 Function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.9976e-13&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="initialization-from-a-file">
<h3><a class="toc-backref" href="#id84">Initialization from a file</a><a class="headerlink" href="#initialization-from-a-file" title="Permalink to this headline">¶</a></h3>
<p>Some data can be initialized from files. Additional sublist has to be
added to named sublist of the <cite>“state</cite>” list with the file name and
the name of attribute.  For a serial run, the file extension must be
<cite>“.exo</cite>”.  For a parallel run, it must be <cite>“.par</cite>”.  Here is an
example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;permeability&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;exodus file initialization&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_with_data.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;perm&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_viscosity&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.001&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="boundaryconditions">
<h2><a class="toc-backref" href="#id85">BoundaryConditions</a><a class="headerlink" href="#boundaryconditions" title="Permalink to this headline">¶</a></h2>
<p>In general, boundary conditions are provided in a heirarchical list by
boundary condition type, then functional form.  Boundary condition specs are
split between two types – those which require a user-provided function
(i.e. Dirichlet data, etc) and those which do not (i.e. zero gradient
conditions).</p>
<p>A list of conditions might pull in both Dirichlet and Neumann data on
different regions, or use different functions on different regions.  The
following example illustrates how boundary conditions are prescribed across
the domain for a typical PK:</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_TYPE&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_FUNCTION_NAME&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC east&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{east}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_FUNCTION_NAME&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;102325.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC north&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{north}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;zero gradient&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC south&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{south}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Different PKs populate this general format with different names, replacing
DIRICHLET_TYPE and DIRICHLET_FUNCTION_NAME.</p>
<div class="section" id="flow-specific-boundary-conditions">
<h3><a class="toc-backref" href="#id86">Flow-specific Boundary Conditions</a><a class="headerlink" href="#flow-specific-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>Flow boundary conditions must follow the general format shown in
<a class="reference internal" href="#boundaryconditions">BoundaryConditions</a>.  Specific conditions implemented include:</p>
<div class="section" id="dirichlet-pressure-boundary-conditions">
<h4><a class="toc-backref" href="#id87">Dirichlet (pressure) boundary conditions</a><a class="headerlink" href="#dirichlet-pressure-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Used for both surface and subsurface flows, this provides pressure data on
boundaries (in [Pa]).</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary pressure&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="neumann-mass-flux-boundary-conditions">
<h4><a class="toc-backref" href="#id88">Neumann (mass flux) boundary conditions</a><a class="headerlink" href="#neumann-mass-flux-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Used for both surface and subsurface flows, this provides mass flux data (in [mol m^-2 s^-1], in the outward normal direction) on boundaries.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;-1.e-3&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="seepage-face-boundary-conditions">
<h4><a class="toc-backref" href="#id89">Seepage face boundary conditions</a><a class="headerlink" href="#seepage-face-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>A variety of seepage face boundary conditions are permitted for both surface
and subsurface flow PKs.  Typically seepage conditions are of the form:</p>
<blockquote>
<div><ul class="simple">
<li>if <span class="math notranslate nohighlight">\(q \cdot \hat{n} &lt; 0\)</span>, then <span class="math notranslate nohighlight">\(q = 0\)</span></li>
<li>if <span class="math notranslate nohighlight">\(p &gt; p0\)</span>, then <span class="math notranslate nohighlight">\(p = p0\)</span></li>
</ul>
</div></blockquote>
<p>This ensures that flow is only out of the domain, but that the max pressure on
the boundary is specified by <span class="math notranslate nohighlight">\(p0\)</span>.</p>
<p>Example: pressure (for surface or subsurface)</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face pressure&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary pressure&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Example: head (for surface)</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face head&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary head&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Additionally, an infiltration flux may be prescribed, which describes the max
flux.  This is for surface faces on which a typical precipitation rate might
be prescribed, to be enforced until the water table rises to the surface, at
which point the precip is turned off and water seeps into runoff.  This
capability is experimental and has not been well tested.</p>
<blockquote>
<div><ul class="simple">
<li>if <span class="math notranslate nohighlight">\(q \cdot \hat{n} &lt; q_0\)</span>, then <span class="math notranslate nohighlight">\(q = q_0\)</span></li>
<li>if <span class="math notranslate nohighlight">\(p &gt; p_{atm}\)</span>, then <span class="math notranslate nohighlight">\(p = p_{atm}\)</span></li>
</ul>
</div></blockquote>
<p>Example: seepage with infiltration</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face with infiltration&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;-1.e-5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Note it would be straightforward to add both p0 and q0 in the same condition;
this has simply not had a use case yet.</p>
</div>
<div class="section" id="dirichlet-head-boundary-conditions">
<h4><a class="toc-backref" href="#id90">Dirichlet (head) boundary conditions</a><a class="headerlink" href="#dirichlet-head-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Used for surface flows, this provides head data (in [m]) on boundaries.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;head&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary head&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.01&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="fixed-level-boundary-conditions">
<h4><a class="toc-backref" href="#id91">Fixed level boundary conditions</a><a class="headerlink" href="#fixed-level-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>For surface flows only.  This fixes the water table at a constant elevation.
It is a head condition that adapts to the surface elevation such that</p>
<div class="math notranslate nohighlight">
\[h = max( h0 - z, 0 )\]</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fixed level&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fixed level&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="zero-head-gradient-boundary-conditions">
<h4><a class="toc-backref" href="#id92">Zero head gradient boundary conditions</a><a class="headerlink" href="#zero-head-gradient-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Used for surface flows, this is an “outlet” boundary condition which looks to
enforce the condition that</p>
<div class="math notranslate nohighlight">
\[\div h \cdot \hat{n} = 0\]</div>
<p>for head <span class="math notranslate nohighlight">\(h\)</span> and outward normal <span class="math notranslate nohighlight">\(\hat{n}\)</span>.  Note that this is an
“outlet” boundary, in the sense that it should really not be used on a
boundary in which</p>
<div class="math notranslate nohighlight">
\[\div z \cdot \hat{n} &gt; 0.\]</div>
<p>This makes it a useful boundary condition for benchmark and 2D problems, where
the elevation gradient is clear, but not so useful for DEM-based meshes.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;zero gradient&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="critical-depth-boundary-conditions">
<h4><a class="toc-backref" href="#id93">Critical depth boundary conditions</a><a class="headerlink" href="#critical-depth-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Also for surface flows, this is an “outlet” boundary condition which looks to
set an outward flux to take away runoff.  This condition is given by:</p>
<div class="math notranslate nohighlight">
\[q = \sqrt{g \hat{z}} n_{liq} h^1.5\]</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;critical depth&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-boundary-condutions">
<h4><a class="toc-backref" href="#id94">Dynamic boundary condutions</a><a class="headerlink" href="#dynamic-boundary-condutions" title="Permalink to this headline">¶</a></h4>
<p>The type of boundary conditions maybe changed in time depending on the switch function of TIME.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;dynamic&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{surface west}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;switch function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;../data/floodplain2.h5&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Time&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Switch&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;form&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{constant}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;bcs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;bc types&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{head, mass flux}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;bc functions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{boundary head, outward mass flux}&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{surface west}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;../data/floodplain2.h5&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Time&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Flux&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;form&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{linear}&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;/ParameterList&gt;</span>
         <span class="nt">&lt;/ParameterList&gt;</span>
       <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;head&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{surface west}&quot;</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary head&quot;</span><span class="nt">&gt;</span>
           <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;../data/floodplain2.h5&quot;</span> <span class="nt">/&gt;</span>
              <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Time&quot;</span> <span class="nt">/&gt;</span>
              <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Head&quot;</span> <span class="nt">/&gt;</span>
              <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;form&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{linear}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/ParameterList&gt;</span>
         <span class="nt">&lt;/ParameterList&gt;</span>
       <span class="nt">&lt;/ParameterList&gt;</span>
     <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="time-integrators-solvers-and-other-mathematical-specs">
<h1><a class="toc-backref" href="#id95">Time integrators, solvers, and other mathematical specs</a><a class="headerlink" href="#time-integrators-solvers-and-other-mathematical-specs" title="Permalink to this headline">¶</a></h1>
<p>Common specs for all solvers and time integrators, used in PKs.</p>
<div class="section" id="timeintegrator">
<h2><a class="toc-backref" href="#id96">TimeIntegrator</a><a class="headerlink" href="#timeintegrator" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Factory for creating TimestepController objects</div></blockquote>
<p>A TimestepController object sets what size timestep to take.  This can be a
variety of things, from fixed timestep size, to adaptive based upon error
control, to adapter based upon simple nonlinear iteration counts.</p>
<ul class="simple">
<li><cite>“timestep controller type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Set the type.  One of the below types.</li>
<li><cite>“timestep controller X parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> List of parameters for a timestep controller of type X.</li>
</ul>
<p>Available types include:</p>
<ul class="simple">
<li><a class="reference internal" href="#timestepcontrollerfixed">TimestepControllerFixed</a>  (type <cite>“fixed</cite>”), a constant timestep</li>
<li><a class="reference internal" href="#timestepcontrollerstandard">TimestepControllerStandard</a> (type <cite>‘standard</cite>”), an adaptive timestep based upon nonlinear iterations</li>
<li><a class="reference internal" href="#timestepcontrollersmarter">TimestepControllerSmarter</a> (type <cite>‘smarter</cite>”), an adaptive timestep based upon nonlinear iterations with more control</li>
<li><a href="#id166"><span class="problematic" id="id167">TimestepControllerAdaptive_</span></a> (type <cite>“adaptive</cite>”), an adaptive timestep based upon error control.</li>
<li><a class="reference internal" href="#timestepcontrollerfromfile">TimestepControllerFromFile</a> (type <cite>“from file</cite>”), uses a timestep history loaded from an HDF5 file.  (Usually only used for regression testing.)</li>
</ul>
<div class="section" id="timestepcontrollerfixed">
<h3><a class="toc-backref" href="#id97">TimestepControllerFixed</a><a class="headerlink" href="#timestepcontrollerfixed" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Timestep controller providing constant timestep size.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">TimestepControllerFixed</span></code> is a simple timestep control mechanism which sets
a constant timestep size.  Note that the actual timestep size is given by the
minimum of PK’s initial timestep sizes.</p>
</div>
<div class="section" id="timestepcontrollerstandard">
<h3><a class="toc-backref" href="#id98">TimestepControllerStandard</a><a class="headerlink" href="#timestepcontrollerstandard" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Simple timestep control based upon previous iteration count.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">TimestepControllerStandard</span></code> is a simple timestep control mechanism
which sets the next timestep based upon the previous timestep and how many
nonlinear iterations the previous timestep took to converge.</p>
<p>The timestep for step <span class="math notranslate nohighlight">\(k+1\)</span>, <span class="math notranslate nohighlight">\(\Delta t_{k+1}\)</span>, is given by:</p>
<ul class="simple">
<li>if <span class="math notranslate nohighlight">\(N_k &gt; N^{max}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{reduction} * \Delta t_{k}\)</span></li>
<li>if <span class="math notranslate nohighlight">\(N_k &lt; N^{min}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{increase} * \Delta t_{k}\)</span></li>
<li>otherwise <span class="math notranslate nohighlight">\(\Delta t_{k+1} = \Delta t_{k}\)</span></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\Delta t_{k}\)</span> is the previous timestep and <span class="math notranslate nohighlight">\(N_k\)</span> is the number of
nonlinear iterations required to solve step <span class="math notranslate nohighlight">\(k\)</span>:.</p>
<ul class="simple">
<li><cite>“max iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{max}\)</span>, decrease the timestep if the previous step took more than this.</li>
<li><cite>“min iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{min}\)</span>, increase the timestep if the previous step took less than this.</li>
<li><cite>“time step reduction factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_reduction\)</span>, reduce the previous timestep by this multiple.</li>
<li><cite>“time step increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_increase\)</span>, increase the previous timestep by this multiple.</li>
<li><cite>“max time step</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> The max timestep size allowed.</li>
<li><cite>“min time step</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> The min timestep size allowed.  If the step has failed and the new step is below this cutoff, the simulation fails.</li>
</ul>
</div>
<div class="section" id="timestepcontrollersmarter">
<h3><a class="toc-backref" href="#id99">TimestepControllerSmarter</a><a class="headerlink" href="#timestepcontrollersmarter" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Slightly smarter timestep controller based upon a history of previous timesteps.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">TimestepControllerSmarter</span></code> is based on <code class="docutils literal notranslate"><span class="pre">TimestepControllerStandard</span></code>, but
also tries to be a bit smarter to avoid repeated increase/decrease loops where
the step size decreases, converges in few iterations, increases, but then
fails again.  It also tries to grow the step geometrically to more quickly
recover from tricky nonlinearities.</p>
<ul class="simple">
<li><cite>“max iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{max}\)</span>, decrease the timestep if the previous step took more than this.</li>
<li><cite>“min iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{min}\)</span>, increase the timestep if the previous step took less than this.</li>
<li><cite>“time step reduction factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_reduction\)</span>, reduce the previous timestep by this multiple.</li>
<li><cite>“time step increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_increase\)</span>, increase the previous timestep by this multiple.  Note that this can be modified geometrically in the case of repeated successful steps.</li>
<li><cite>“max time step increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>10.</strong> The max <span class="math notranslate nohighlight">\(f_increase\)</span> will ever get.</li>
<li><cite>“growth wait after fail</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Wait at least this many timesteps before attempting to grow the timestep after a failed timestep.</li>
<li><cite>“count before increasing increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Require this many successive increasions before multiplying <span class="math notranslate nohighlight">\(f_increase\)</span> by itself.</li>
</ul>
</div>
<div class="section" id="timestepcontrollerfromfile">
<h3><a class="toc-backref" href="#id100">TimestepControllerFromFile</a><a class="headerlink" href="#timestepcontrollerfromfile" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Timestep controller which loads a timestep history from file.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">TimestepControllerFromFile</span></code> loads a timestep history from a file, then
advances the step size with those values.  This is mostly used for testing
purposes, where we need to force the same timestep history as previous runs to
do regression testing.  Otherwise even machine roundoff can eventually alter
number of iterations enough to alter the timestep history, resulting in
solutions which are enough different to cause doubt over their correctness.</p>
<ul class="simple">
<li><cite>“file name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Path to hdf5 file containing timestep information.</li>
<li><cite>“timestep header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Name of the dataset containing the history of timestep sizes.</li>
</ul>
</div>
</div>
<div class="section" id="linear-solver">
<h2><a class="toc-backref" href="#id101">Linear Solver</a><a class="headerlink" href="#linear-solver" title="Permalink to this headline">¶</a></h2>
<p>Linear solver are almost exclusively iterative methods with a separate provided preconditioner.</p>
<div class="section" id="linear-solver-pcg">
<h3><a class="toc-backref" href="#id102">Linear Solver: PCG</a><a class="headerlink" href="#linear-solver-pcg" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Preconditioned conjugate gradient method for a linear solver.</div></blockquote>
<p>Parameters:</p>
<ul class="simple">
<li><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</li>
<li><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</li>
<li><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</li>
<li><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>“{relative rhs}”</strong> A list of
criteria, any of which can be applied.  Valid include:<ul>
<li><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</li>
<li><cite>“relative residual</cite>” : measure error relative to the norm of the residual</li>
<li><cite>“absolute residual</cite>” : measure error directly, norm of error</li>
<li><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="linear-solver-gmres">
<h3><a class="toc-backref" href="#id103">Linear Solver: GMRES</a><a class="headerlink" href="#linear-solver-gmres" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Generalized minimum residual method for a linear solver.</div></blockquote>
<p>Based on the methods of Yu. Kuznetsov, 1968; Y.Saad, 1986.  Deflated version of
GMRES is due to R.Morgan, GMRES with deflated restarting, 2002 SISC; S.Rollin,
W.Fichtner, Improving accuracy of GMRES with deflated restarting, 2007 SISC.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</li>
<li><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</li>
<li><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</li>
<li><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>“{relative rhs}”</strong> A list of
criteria, any of which can be applied.  Valid include:<ul>
<li><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</li>
<li><cite>“relative residual</cite>” : measure error relative to the norm of the residual</li>
<li><cite>“absolute residual</cite>” : measure error directly, norm of error</li>
<li><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</li>
</ul>
</li>
<li><cite>“size of Krylov space</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Size of the Krylov space used to span the residual.</li>
<li><cite>“controller training start</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Start iteration for determining
convergence rates. (Add more please!)</li>
<li><cite>“controller training end</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> Start iteration for determining
convergence rates. (Add more please!)</li>
<li><cite>“preconditioning strategy</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>left</strong> Valid are “left” and
“right”-type preconditioning (see Saad 1986)</li>
<li><cite>“maximum size of deflation space</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Size of the deflation space, see Rollin et al.</li>
</ul>
</div>
<div class="section" id="linear-solver-nka">
<h3><a class="toc-backref" href="#id104">Linear Solver: NKA</a><a class="headerlink" href="#linear-solver-nka" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Uses NKA method as a linear solver.</div></blockquote>
<p>This is effectively equivalent to GMRES with a rolling restart, where vectors
fall off the end of the space.</p>
<p>Parameters:</p>
<ul class="simple">
<li><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</li>
<li><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</li>
<li><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</li>
<li><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>“{relative rhs}”</strong> A list of
criteria, any of which can be applied.  Valid include:<ul>
<li><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</li>
<li><cite>“relative residual</cite>” : measure error relative to the norm of the residual</li>
<li><cite>“absolute residual</cite>” : measure error directly, norm of error</li>
<li><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</li>
</ul>
</li>
<li><cite>“max nka vectors</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Size of the NKA space used to span the residual, conceptually equivalent to the size of the Krylov space.</li>
<li><cite>“nka vector tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.05</strong> Vectors whose dot product are within this tolerance are considered parallel, and therefore the old vector is thrown out.</li>
</ul>
<p>Calef et al. “Nonlinear Krylov acceleration applied to a discrete ordinates formulation of the k-eigenvalue problem.” JCP 238 (2013): 188-209.</p>
</div>
<div class="section" id="linear-solver-amesos">
<h3><a class="toc-backref" href="#id105">Linear Solver: Amesos</a><a class="headerlink" href="#linear-solver-amesos" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="linear-solver-belos-gmres">
<h3><a class="toc-backref" href="#id106">Linear Solver: Belos GMRES</a><a class="headerlink" href="#linear-solver-belos-gmres" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="preconditioner">
<h2><a class="toc-backref" href="#id107">Preconditioner</a><a class="headerlink" href="#preconditioner" title="Permalink to this headline">¶</a></h2>
<p>These can be used by a process kernel lists to define a preconditioner.  The only common parameter required by all lists is the type:</p>
<blockquote>
<div><ul class="simple">
<li><cite>“preconditioner type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“identity”</strong>, <cite>“boomer amg</cite>”, <cite>“trilinos ml</cite>”, <cite>“block ilu</cite>” ???</li>
<li><cite>“PC TYPE parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> includes a list of parameters specific to the type of PC.</li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;my preconditioner&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;trilinos ml&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;trilinos ml parameters&quot;</span><span class="nt">&gt;</span> ?????? check me!
       ...
   <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="hypre-s-boomer-amg">
<h3><a class="toc-backref" href="#id108">Hypre’s Boomer AMG</a><a class="headerlink" href="#hypre-s-boomer-amg" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>PreconditionerBoomerAMG: HYPRE’s multigrid preconditioner.</div></blockquote>
<p>Internal parameters for Boomer AMG include</p>
<ul class="simple">
<li><cite>“tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> if is not zero, the preconditioner is dynamic
and approximate the inverse matrix with the prescribed tolerance (in
the energy norm ???).</li>
<li><cite>“smoother sweeps</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> defines the number of smoothing loops. Default is 3.</li>
<li><cite>“cycle applications</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>5</strong> defines the number of V-cycles.</li>
<li><cite>“strong threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.5</strong> defines the number of V-cycles. Default is 5.</li>
<li><cite>“relaxation type</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>6</strong> defines the smoother to be used. Default is 6
which specifies a symmetric hybrid Gauss-Seidel / Jacobi hybrid method. TODO: add others!</li>
<li><cite>“coarsen type</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> defines the coarsening strategy to be used. Default is 0
which specifies a Falgout method. TODO: add others!</li>
<li><cite>“max multigrid levels</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> optionally defined the maximum number of multigrid levels.</li>
<li><dl class="first docutils">
<dt><cite>“use block indices</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> If true, uses the <a href="#id2"><span class="problematic" id="id3">`</span></a>”systems of</dt>
<dd>PDEs`” code with blocks given by the SuperMap, or one per DoF per entity
type.</dd>
</dl>
</li>
<li><cite>“number of functions</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> Any value &gt; 1 tells Boomer AMG to
use the <cite>“systems of PDEs</cite>” code with strided block type.  Note that, to use
this approach, unknowns must be ordered with DoF fastest varying (i.e. not
the native Epetra_MultiVector order).  By default, it uses the <cite>“unknown</cite>”
approach in which each equation is coarsened and interpolated independently.</li>
<li><dl class="first docutils">
<dt><cite>“nodal strength of connection norm</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> tells AMG to coarsen such</dt>
<dd>that each variable has the same coarse grid - sometimes this is more
“physical” for a particular problem. The value chosen here for nodal
determines how strength of connection is determined between the
coupled system.  I suggest setting nodal = 1, which uses a Frobenius
norm.  This does NOT tell AMG to use nodal relaxation.
Default is 0.</dd>
</dl>
</li>
<li><cite>“verbosity</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> prints a summary of run time settings and
timing information to stdout.  <cite>“1</cite>” prints coarsening info, <cite>“2</cite>” prints
smoothing info, and <cite>“3</cite>’” prints both.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boomer amg parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;tolerance&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother sweeps&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;strong threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarsen type&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;relaxation type&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verbosity&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of functions&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="trilinos-ml">
<h3><a class="toc-backref" href="#id109">Trilinos ML</a><a class="headerlink" href="#trilinos-ml" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>PreconditionerML: Trilinos ML multigrid.</div></blockquote>
<p>Internal parameters of Trilinos ML includes</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;ml parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;ML output&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.33&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: nodes per aggregate&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Uncoupled&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Amesos-KLU&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: max size&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;eigen-analysis: iterations&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;eigen-analysis: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cg&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;max levels&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;prec type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;MGW&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: pre or post&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;both&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: sweeps&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Gauss-Seidel&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="block-ilu">
<h3><a class="toc-backref" href="#id110">Block ILU</a><a class="headerlink" href="#block-ilu" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>PreconditionerBlockILU:   Incomplete LU preconditioner.</div></blockquote>
<p>The internal parameters for block ILU are as follows:</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;block ilu parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: relax value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: absolute threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: relative threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: level-of-fill&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;overlap&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;schwarz: combine mode&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Add&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="indentity">
<h3><a class="toc-backref" href="#id111">Indentity</a><a class="headerlink" href="#indentity" title="Permalink to this headline">¶</a></h3>
<p>The default, no PC applied.</p>
</div>
</div>
<div class="section" id="nonlinearsolver">
<h2><a class="toc-backref" href="#id112">NonlinearSolver</a><a class="headerlink" href="#nonlinearsolver" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="other-common-specs">
<h1><a class="toc-backref" href="#id113">Other Common Specs</a><a class="headerlink" href="#other-common-specs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ioevent">
<h2><a class="toc-backref" href="#id114">IOEvent</a><a class="headerlink" href="#ioevent" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>IOEvent: base time/timestep control determing when in time to do something.</div></blockquote>
<p>The IOEvent is used for multiple objects that need to indicate simulation times or cycles on which to do something.</p>
<ul>
<li><p class="first"><cite>“cycles start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> <strong>optional</strong></p>
<blockquote>
<div><p>The first entry is the start cycle, the second is the cycle
period, and the third is the stop cycle or -1, in which case there
is no stop cycle. A visualization dump is written at such
cycles that satisfy cycle = start + n*period, for n=0,1,2,… and
cycle &lt; stop if stop != -1.0.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“cycles start period stop 0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> <strong>optional</strong></p>
<blockquote>
<div><p>If multiple cycles start period stop parameters are needed, then use these
parameters.  If one with 0 is found, then one with 1 is looked for, etc,
until the Nth one is not found.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“cycles</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code>  <strong>optional</strong></p>
<blockquote>
<div><p>An array of discrete cycles that at which a visualization dump is
written.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> <strong>optional</strong></p>
<blockquote>
<div><p>The first entry is the start time, the second is the time period,
and the third is the stop time or -1, in which case there is no
stop time. A visualization dump is written at such times that
satisfy time = start + n*period, for n=0,1,2,… and time &lt; stop
if stop != -1.0.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times start period stop units</cite>” <code class="docutils literal notranslate"><span class="pre">string</span></code> <strong>s</strong></p>
<blockquote>
<div><p>Units corresponding to this spec.  One of <cite>“s</cite>”, <cite>“d</cite>”, <cite>“yr</cite>”, or <cite>“yr 365</cite>”</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times start period stop 0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> <strong>optional</strong></p>
<blockquote>
<div><p>If multiple start period stop parameters are needed, then use this these
parameters with N=0,1,2.  If one with 0 is found, then one with 1 is
looked for, etc, until the Nth one is not found.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times start period stop 0 units</cite>” <code class="docutils literal notranslate"><span class="pre">string</span></code> <strong>s</strong></p>
<blockquote>
<div><p>Units corresponding to this spec.  One of <cite>“s</cite>”, <cite>“d</cite>”, <cite>“yr</cite>”, or <cite>“yr 365</cite>”
See above for continued integer listings.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> <strong>optional</strong></p>
<blockquote>
<div><p>An array of discrete times that at which a visualization dump
shall be written.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>“times units</cite>” <code class="docutils literal notranslate"><span class="pre">string</span></code> <strong>s</strong></p>
<blockquote>
<div><p>Units corresponding to this spec.  One of <cite>“s</cite>”, <cite>“d</cite>”, <cite>“yr</cite>”, or <cite>“yr 365</cite>”</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="verboseobject">
<h2><a class="toc-backref" href="#id115">VerboseObject</a><a class="headerlink" href="#verboseobject" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>VerboseObject: a controller for writing log files on multiple cores with varying verbosity.</div></blockquote>
<p>This allows control of log-file verbosity for a wide variety of objects
and physics.</p>
<ul>
<li><p class="first"><cite>“verbosity level</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>GLOBAL_VERBOSITY</strong>, <cite>“low</cite>”, <cite>“medium</cite>”, <cite>“high</cite>”, <cite>“extreme</cite>”</p>
<blockquote>
<div><p>The default is set by the global verbosity spec, (fix me!)  Typically,
<cite>“low</cite>” prints out minimal information, <cite>“medium</cite>” prints out errors and
overall high level information, <cite>“high</cite>” prints out basic debugging, and
<cite>“extreme</cite>” prints out local debugging information.</p>
</div></blockquote>
</li>
</ul>
<p>Note: while there are other options, users should typically not need them.
Instead, developers can use them to control output.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;medium&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my header&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;hide line prefix&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;write on rank&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="function">
<h2><a class="toc-backref" href="#id116">Function</a><a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Function: base class for all functions of space and time.</div></blockquote>
<p>Analytic, algabraic functions of space and time are used for a variety of
purposes, including boundary conditions, initial conditions, and independent
variables.</p>
<p>For initial conditions, functions are prescribed of space only, i.e.</p>
<p><span class="math notranslate nohighlight">\(u = f(x,y,z)\)</span></p>
<p>For boundary conditions and independent variables, functions are also a
function of time:</p>
<p><span class="math notranslate nohighlight">\(u = f(t,x,y,z)\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code></p>
<p>ONE OF:
* <cite>“function: constant</cite>” <code class="docutils literal notranslate"><span class="pre">[constant-function-spec]</span></code>
OR:
* <cite>“function: tabular</cite>” <code class="docutils literal notranslate"><span class="pre">[tabular-function-spec]</span></code>
OR:
* <cite>“function: smooth step</cite>” <code class="docutils literal notranslate"><span class="pre">[smooth-step-function-spec]</span></code>
OR:
* <cite>“function: polynomial</cite>” <code class="docutils literal notranslate"><span class="pre">[polynomial-function-spec]</span></code>
OR:
* <cite>“function: monomial</cite>” <code class="docutils literal notranslate"><span class="pre">[monomial-function-spec]</span></code>
OR:
* <cite>“function: linear</cite>” <code class="docutils literal notranslate"><span class="pre">[linear-function-spec]</span></code>
OR:
* <cite>“function: separable</cite>” <code class="docutils literal notranslate"><span class="pre">[separable-function-spec]</span></code>
OR:
* <cite>“function: additive</cite>” <code class="docutils literal notranslate"><span class="pre">[additive-function-spec]</span></code>
OR:
* <cite>“function: multiplicative</cite>” <code class="docutils literal notranslate"><span class="pre">[multiplicative-function-spec]</span></code>
OR:
* <cite>“function: composition</cite>” <code class="docutils literal notranslate"><span class="pre">[composition-function-spec]</span></code>
OR:
* <cite>“function: static head</cite>” <code class="docutils literal notranslate"><span class="pre">[static-head-function-spec]</span></code>
OR:
* <cite>“function: standard math</cite>” <code class="docutils literal notranslate"><span class="pre">[standard-math-function-spec]</span></code>
OR:
* <cite>“function: bilinear</cite>” <code class="docutils literal notranslate"><span class="pre">[bilinear-function-spec]</span></code>
OR:
* <cite>“function: distance</cite>” <code class="docutils literal notranslate"><span class="pre">[distance-function-spec]</span></code>
#OR:
#* <cite>“function: squared distance</cite>” <code class="docutils literal notranslate"><span class="pre">[squared-distance-function-spec]</span></code>
END</p>
<p>It is straightforward to add new functions as needed.</p>
<div class="section" id="constant-function">
<h3><a class="toc-backref" href="#id117">Constant Function</a><a class="headerlink" href="#constant-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionConstant: Implements the Function interface using a constant value.</div></blockquote>
<p>Constant function is defined as <span class="math notranslate nohighlight">\(f(x) = a\)</span>, for all <span class="math notranslate nohighlight">\(x\)</span>.</p>
<ul class="simple">
<li><cite>“value</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> The constant to be applied.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="tabular-function">
<h3><a class="toc-backref" href="#id118">Tabular Function</a><a class="headerlink" href="#tabular-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionTabular: Piecewise-defined function.</div></blockquote>
<p>A piecewise function of one variable.</p>
<p>A tabular function is tabulated on a series of intervals; given values
<span class="math notranslate nohighlight">\({{x_i}}, {{y_i}},, i=0, ... n-1\)</span> and functional forms <span class="math notranslate nohighlight">\({{f_j}},,
j=0, ... n-2\)</span> a tabular function <span class="math notranslate nohighlight">\(f(x)\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
f(x) &amp;=&amp; y_0, &amp; x \le x_0,\\
f(x) &amp;=&amp; f_{{i-1}}(x)  &amp; x \in (x_{{i-1}}, x_i],\\
f(x) &amp;=&amp; y_{{n-1}}, &amp; x &gt; x_{{n-1}}.
\end{matrix}\end{split}\]</div>
<p>The functional forms <span class="math notranslate nohighlight">\({f_j}\)</span> may be constant, which uses the left endpoint, i.e.</p>
<p><span class="math notranslate nohighlight">\(f_i(x) = y_i\)</span>,</p>
<p>linear, i.e.</p>
<p><span class="math notranslate nohighlight">\(f_i(x) = ( y_i * (x - x_i) + y_{{i+1}} * (x_{{i+1}} - x) ) / (x_{{i+1}} - x_i)\)</span></p>
<p>or arbitrary, in which the <span class="math notranslate nohighlight">\(f_j\)</span> must be provided.</p>
<p>The <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> may be provided in one of two ways – explicitly in the input spec or from an HDF5 file.  The length of these must be equal, and the <span class="math notranslate nohighlight">\(x_i\)</span> must be monotonically increasing.  Forms, as defined on intervals, must be of length equal to the length of the <span class="math notranslate nohighlight">\(x_i\)</span> less one.</p>
<p>Explicitly specifying the data:</p>
<ul class="simple">
<li><cite>“x values</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the <span class="math notranslate nohighlight">\(x_i\)</span></li>
<li><cite>“y values</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the <span class="math notranslate nohighlight">\(y_i\)</span></li>
<li><cite>“forms</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{linear,…}</strong> Form of the interpolant, either <cite>“constant</cite>”, <cite>“linear</cite>”, or <cite>“USER_DEFINED</cite>”</li>
<li><cite>“USER_DEFINED</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> user-provided functional forms on the interval</li>
<li><cite>“x coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>t</strong>, <cite>“x</cite>”, <cite>“y</cite>”, <cite>“z</cite>” defines which coordinate direction the <span class="math notranslate nohighlight">\(x_i\)</span> are formed, defaulting to time.</li>
</ul>
<p>The below example defines a function that is zero on interval <span class="math notranslate nohighlight">\((-\infty,\,0]\)</span>,
linear on interval <span class="math notranslate nohighlight">\((0,\,1]\)</span>, constant (<cite>f(x)=1</cite>) on interval <span class="math notranslate nohighlight">\((1,\,2]\)</span>,
square root of <cite>t</cite> on interval <span class="math notranslate nohighlight">\((2,\,3]\)</span>,
and constant (<cite>f(x)=2</cite>) on interval <span class="math notranslate nohighlight">\((3,\,\infty]\)</span>.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x values&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y values&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 2.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;forms&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{linear, constant, USER_FUNC}&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;USER_FUNC&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;operator&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Loading table from file (note that <cite>“USER_DEFINED</cite>” is not an option here, but could be made so if requested):</p>
<ul class="simple">
<li><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> filename of the HDF5 data</li>
<li><cite>“x header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the dataset for the <span class="math notranslate nohighlight">\(x_i\)</span> in the file</li>
<li><cite>“y header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the dataset for the <span class="math notranslate nohighlight">\(y_i\)</span> in the file</li>
<li><cite>“forms</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{linear,…}</strong>, Form of the interpolant, either <cite>“constant</cite>”, <cite>“linear</cite>”, or <cite>“USER_DEFINED</cite>”.</li>
</ul>
<p>The example below would perform linear-interpolation on the intervals provided by data within the hdf5 file <cite>“my_data.h5</cite>”.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my_data.h5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/data&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="smooth-step-function">
<h3><a class="toc-backref" href="#id119">Smooth step Function</a><a class="headerlink" href="#smooth-step-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionSmoothStep: a smoothed discontinuity.</div></blockquote>
<p>A smooth <span class="math notranslate nohighlight">\(C^2\)</span> function <cite>f(x)</cite> on interval <span class="math notranslate nohighlight">\([x_0,\,x_1]\)</span> is
defined such that <cite>f(x) = y_0</cite> for <cite>x &lt; x0</cite>, <cite>f(x) = y_1</cite> for <cite>x &gt; x_1</cite>, and
monotonically increasing for <span class="math notranslate nohighlight">\(x \in [x_0, x_1]\)</span> through cubic
interpolation.</p>
<ul class="simple">
<li><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> First fitting point</li>
<li><cite>“y0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> First fitting value</li>
<li><cite>“x1</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Second fitting point</li>
<li><cite>“y1</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Second fitting value</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-smooth-step&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x1&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y1&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;2.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="polynomial-function">
<h3><a class="toc-backref" href="#id120">Polynomial Function</a><a class="headerlink" href="#polynomial-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionPolynomial: a polynomial</div></blockquote>
<p>A generic polynomial function is given by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = \sum_{{j=0}}^n c_j (x - x_0)^{{p_j}}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_j\)</span> are coefficients of monomials,
<span class="math notranslate nohighlight">\(p_j\)</span> are integer exponents, and <span class="math notranslate nohighlight">\(x_0\)</span> is the reference point.</p>
<ul class="simple">
<li><cite>“coefficients</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> c_j polynomial coefficients</li>
<li><cite>“exponents</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> p_j polynomail exponents</li>
<li><cite>“reference point</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> x0 to which polynomial argument is normalized.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-polynomial&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coefficients&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{1.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;exponents&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 4}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;reference point&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-variable-linear-function">
<h3><a class="toc-backref" href="#id121">Multi-variable linear Function</a><a class="headerlink" href="#multi-variable-linear-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionLinear: a multivariate linear function.</div></blockquote>
<p>A multi-variable linear function is formally defined by</p>
<div class="math notranslate nohighlight">
\[f(x) = y_0 + \sum_{{j=0}}^{{n-1}} g_j (x_j - x_{{0,j}})\]</div>
<p>with the constant term “math:<cite>y_0</cite> and gradient <span class="math notranslate nohighlight">\(g_0,\, g_1\,..., g_{{n-1}}\)</span>.
If the reference point <span class="math notranslate nohighlight">\(x_0\)</span> is specified, it must have the same
number of values as the gradient.  Otherwise, it defaults to zero.
Note that one of the parameters in a multi-valued linear function can be time.</p>
<ul class="simple">
<li><cite>“y0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> y_0 in f = y0 + g * (x - x0)</li>
<li><cite>“gradient</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> g in f = y0 + g * (x - x0)</li>
<li><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> x0 in f = y0 + g * (x - x0)</li>
</ul>
<p>Conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">gradient</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-linear&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gradient&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{1.0, 2.0, 3.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{2.0, 3.0, 1.0}}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="separable-function">
<h3><a class="toc-backref" href="#id122">Separable Function</a><a class="headerlink" href="#separable-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionSeparable: f(x,y) = f1(x)*f2(y)</div></blockquote>
<p>A separable function is defined as the product of other functions such as</p>
<div class="math notranslate nohighlight">
\[f(x_0, x_1,...,x_{{n-1}}) = f_1(x_0)\, f_2(x_1,...,x_{{n-1}})\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<ul class="simple">
<li><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_1 in f(x) = f_1(x0) * f_2(x1…)</li>
<li><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_2 in f(x) = f_1(x0) * f_2(x1…)</li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-separable&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="additive-function">
<h3><a class="toc-backref" href="#id123">Additive Function</a><a class="headerlink" href="#additive-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionAdditive: f(x,y) = f1(x,y) + f2(x,y)</div></blockquote>
<p>An additive function simply adds two other function results together.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1(x) + f_2(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<ul class="simple">
<li><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_1 in f(x) = f_1(x) + f_2(x)</li>
<li><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_2 in f(x) = f_1(x) + f_2(x)</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-additive&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="multiplicative-function">
<h3><a class="toc-backref" href="#id124">Multiplicative Function</a><a class="headerlink" href="#multiplicative-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionMultiplicative: f(x,y) = f1(x,y) * f2(x,y)</div></blockquote>
<p>A multiplicative function simply multiplies two other function results together.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1(x) * f_2(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<ul class="simple">
<li><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_1 in f(x) = f_1(x) + f_2(x)</li>
<li><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_2 in f(x) = f_1(x) + f_2(x)</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-multiplicative&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="composition-function">
<h3><a class="toc-backref" href="#id125">Composition Function</a><a class="headerlink" href="#composition-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionComposition: f(x,y) = f1(x,y) * f2(x,y)</div></blockquote>
<p>Function composition simply applies one function to the result of another.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1( f_2(x) )\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<ul class="simple">
<li><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_1 in f(x) = f_1(f_2(x))</li>
<li><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> f_2 in f(x) = f_1(f_2(x))</li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-composition&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="piecewise-bilinear-function">
<h3><a class="toc-backref" href="#id126">Piecewise Bilinear Function</a><a class="headerlink" href="#piecewise-bilinear-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionBilinear: a piecewise bilinear function.</div></blockquote>
<p>A piecewise bilinear function extends the linear form of the tabular function to two variables.</p>
<p>Define <span class="math notranslate nohighlight">\(i(x) = i : x_i &lt; x &lt;= x_{{i+1}}\)</span> and similarly <span class="math notranslate nohighlight">\(j(y) = j : y_j &lt; y &lt;= y_{{j+1}}\)</span> for monotonically increasing <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_j\)</span>.</p>
<p>Given a two-dimensional array <span class="math notranslate nohighlight">\(u_{{i,j}}\)</span>, <span class="math notranslate nohighlight">\(f\)</span> is then defined by
bilinear interpolation on <span class="math notranslate nohighlight">\(u_{{i(x),j(y)}}, u_{{i(x)+1,j(y)}},
u_{{i(x),j(y)+1}}, u_{{i(x)+1,j(y)+1}}, if :math:\)</span> is in
<span class="math notranslate nohighlight">\([x_0,x_n] \times [y_0,y_m]\)</span>, linear interpolation if one of <span class="math notranslate nohighlight">\(x,y\)</span>
are out of those bounds, and constant at the corner value if both are out of
bounds.</p>
<ul class="simple">
<li><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> HDF5 filename of the data</li>
<li><cite>“row header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the row dataset, the <span class="math notranslate nohighlight">\(x_i\)</span></li>
<li><cite>“row coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> one of <cite>“t</cite>”,`”x`”,`”y`”,`”z`”</li>
<li><cite>“column header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the column dataset, the <span class="math notranslate nohighlight">\(y_i\)</span></li>
<li><cite>“column coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> one of <cite>“t</cite>”,`”x`”,`”y`”,`”z`”</li>
<li><cite>“value header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the values dataset, the <span class="math notranslate nohighlight">\(u_{{i,j}}\)</span></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-bilinear&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;pressure.h5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;row header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;row coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;column header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/x&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;column coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;x&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/pressure&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="distance-function">
<h3><a class="toc-backref" href="#id127">Distance Function</a><a class="headerlink" href="#distance-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionDistance: distance from a reference point.</div></blockquote>
<p>A distance function calculates distance from reference point <span class="math notranslate nohighlight">\(x_0\)</span>
using by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = \sqrt( \sum_{j=0}^{n} m_j (x_j - x_{0,j})^2 )\]</div>
<p>Note that the first parameter in <span class="math notranslate nohighlight">\(x\)</span> can be time.</p>
<ul class="simple">
<li><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point from which distance is measured.</li>
<li><cite>“metric</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Linear scaling metric, typically all 1s.</li>
</ul>
<p>Here is an example of a distance function using isotropic metric:</p>
<p>Example:
.. code-block:: xml</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;ParameterList name=”function-distance”&gt;</dt>
<dd>&lt;Parameter name=”x0” type=”Array(double)” value=”{1.0, 3.0, 0.0}”/&gt;
&lt;Parameter name=”metric” type=”Array(double)” value=”{1.0, 1.0, 1.0}”/&gt;</dd>
</dl>
<p>&lt;/ParameterList&gt;</p>
</div></blockquote>
</div>
<div class="section" id="monomial-function">
<h3><a class="toc-backref" href="#id128">Monomial Function</a><a class="headerlink" href="#monomial-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionMonomial: a multivariate monomial function.</div></blockquote>
<p>A multi-variable monomial function is given by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = c \prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}\]</div>
<p>with the constant factor <span class="math notranslate nohighlight">\(c\)</span>, the reference point <span class="math notranslate nohighlight">\(x_0\)</span>, and
integer exponents <span class="math notranslate nohighlight">\(p_j\)</span>.
Note that the first parameter in <span class="math notranslate nohighlight">\(x\)</span> can be time.</p>
<ul class="simple">
<li><cite>“c</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> c in f = c prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}</li>
<li><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> x0 in f = c prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}</li>
<li><cite>“exponents</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> p in f = c prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}</li>
</ul>
<p>Conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">exponents</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is an example of monomial of degree 6 in three variables:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-monomial&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;c&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{1.0, 3.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;exponents&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="standard-math-function">
<h3><a class="toc-backref" href="#id129">Standard Math Function</a><a class="headerlink" href="#standard-math-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FunctionStandardMath: provides access to many common mathematical functions.</div></blockquote>
<p>These functions allow to set up non-trivial time-dependent boundary conditions
which increases a set of analytic solutions that can be used in convergence
analysis tests.</p>
<div class="math notranslate nohighlight">
\[f(x) = A * operator( p * (x - s) )\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[f(x) = A * operator(x-s, p)\]</div>
<p>Note that these operate only on the first coordinate, which is often time.
Function composition can be used to apply these to other coordinates (or
better yet a dimension could/should be added upon request).</p>
<ul class="simple">
<li><cite>“operator</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the name of a standard mathematical function.
Available options are <cite>“cos</cite>”, <cite>“sin</cite>”, <cite>“tan</cite>”, <cite>“acos</cite>”, <cite>“asin</cite>”, <cite>“atan</cite>”,
<cite>“cosh</cite>”, <cite>“sinh</cite>”, <cite>“tanh</cite>”, <cite>“exp</cite>”, <cite>“log</cite>”, <cite>“log10</cite>”, <cite>“sqrt</cite>”, <cite>“ceil</cite>”,
<cite>“fabs</cite>”, <cite>“floor</cite>”, <cite>“mod</cite>”, and <cite>“pow</cite>”.</li>
<li><cite>“amplitude</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies a multiplication factor <cite>a</cite> in formula <cite>a f(x)</cite>.
The multiplication factor is ignored by function <cite>mod</cite>. Default value is 1.</li>
<li><cite>“parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> specifies additional parameter <cite>p</cite> for
math functions with two arguments. These functions are <cite>“a pow(x[0], p)</cite>”
and <cite>“a mod(x[0], p)</cite>”.  Alternative, scales the argument before
application, for use in changing the period of trig functions.</li>
<li><cite>“shift</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies a shift of the function argument. Default is 0.</li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;operator&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;amplitude&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1e-7&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;shift&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example defines function <cite>1e-7 sqrt(t-0.1)</cite>.</p>
</div>
</div>
<div class="section" id="operator">
<h2><a class="toc-backref" href="#id130">Operator</a><a class="headerlink" href="#operator" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Operator represents a linear map, and typically encapsulates a discretization.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">Operator</span></code> represents a map from linear space X to linear space Y.  Typically,
this map is a linear map, and encapsulates much of the discretization involved
in moving from continuous to discrete equations. The spaces X and Y are described
by CompositeVectors (CV). A few maps X-&gt;Y are supported.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">Operator</span></code> provides an interface for applying both the forward and inverse
linear map (assuming the map is invertible).</p>
<p>Typically the <code class="docutils literal notranslate"><span class="pre">Operator</span></code> is never seen by the user; instead the user provides
input information for helper classes based on the continuous mathematical
operator and the desired discretization.  These helpers build the needed
<code class="docutils literal notranslate"><span class="pre">Operator</span></code>, which may include information from multiple helpers (i.e. in the
case of Jacobian Operators for a PDE).</p>
<p>However, one option may be provided by the user, which is related to dealing
with nearly singular operators:</p>
<ul class="simple">
<li><cite>“diagonal shift</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.0</strong> Adds a scalar shift to the diagonal
of the <code class="docutils literal notranslate"><span class="pre">Operator</span></code>, which can be useful if the <code class="docutils literal notranslate"><span class="pre">Operator</span></code> is singular or
near-singular.</li>
</ul>
<div class="section" id="operatoraccumulation">
<h3><a class="toc-backref" href="#id131">OperatorAccumulation</a><a class="headerlink" href="#operatoraccumulation" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PDE_Accumulation</span></code> assembles the discrete form of <span class="math notranslate nohighlight">\(\frac{\partial A}{\partial t}\)</span>.</p>
<p>This class is usually used as part of a preconditioner, providing the linearization:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial A} \left[ \frac{\partial A}{\partial t} \right]_{A_0} i
= \frac{|\Omega_E|}{\Delta t}\]</div>
<p>for a grid element <span class="math notranslate nohighlight">\(\Omega_E\)</span>.</p>
<p>No options are available here.</p>
</div>
<div class="section" id="operatordiffusion">
<h3><a class="toc-backref" href="#id132">OperatorDiffusion</a><a class="headerlink" href="#operatordiffusion" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PDE_Diffusion</span></code> forms local <code class="docutils literal notranslate"><span class="pre">Op</span></code> s and global <code class="docutils literal notranslate"><span class="pre">Operator</span></code> s for elliptic equations:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot k \nabla u\]</div>
<p>with a variety of discretizations. Note also, for reasons that are one part historical
and potentially not that valid, this also supports and implementation with an advective
source, i.e.:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot k (\nabla u + \hat{z})\]</div>
<p>for gravitational terms in Richards equations.</p>
<p>The input spec for a diffusion operator consists of:</p>
<ul class="simple">
<li><cite>“discretization primary</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> See below for supported options.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><cite>“fv: default</cite>” the standard two-point flux finite volume discretization</li>
<li><cite>“nlfv: default</cite>” the nonlinear finite volume method of ???</li>
<li>MFD methods, including:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><cite>“mfd: default</cite>”</li>
<li><cite>“mfd: monotone for hex</cite>”</li>
<li><cite>“mfd: optimized for monotonicity</cite>”</li>
<li><cite>“mfd: two-point flux approximation</cite>”</li>
<li><cite>“mfd: optimized for sparsity</cite>”</li>
<li><cite>“mfd: support operator</cite>”</li>
</ul>
</div></blockquote>
<p>Note that the most commonly used are <cite>“fv: default</cite>” for simple test
problems (this method is not particularly accurate for distorted
meshes), <cite>“mfd: optimized for sparsity</cite>” for most real problems on
unstructured meshes, and <cite>“mfd: optimized for monotonicity</cite>” for
orthogonal meshes with diagonal tensor/scalar coefficients.</p>
</div></blockquote>
<ul class="simple">
<li><cite>“gravity</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> specifies if the gravitational flow term is included</li>
<li><cite>“Newton correction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a model for non-physical terms
that must be added to the matrix. These terms represent Jacobian and are needed
for the preconditioner. Available options are <cite>“true Jacobian</cite>” and <cite>“approximate Jacobian</cite>”.
The FV scheme accepts only the first options. The other schemes accept only the second option.</li>
<li><cite>“scaled constraint equation</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> rescales flux continuity equations
on mesh faces.  These equations are formed without the nonlinear
coefficient. This option allows us to treat the case of zero nonlinear
coefficient, which otherwise generates zero rows in the operator, which is
then singular.  At moment this feature does not work with non-zero gravity
term.</li>
<li><cite>“constraint equation scaling cutoff</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies the cutoff value for
applying rescaling strategy described above.</li>
</ul>
<blockquote>
<div>Diffusion generates local Ops and global Operators for an elliptic operator.</div></blockquote>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;OPERATOR_NAME&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mfd: two-point flux approximation&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;schema&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gravity term discretization&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;hydraulic head&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;nonlinear coefficient&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;upwind: face&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;true Jacobian&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;consistent faces&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Additional options available only for the MFD family of discretizations include:</p>
<ul class="simple">
<li><cite>“nonlinear coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a method for treating nonlinear
diffusion coefficient, if any. Available options are <cite>“none</cite>”, <cite>“upwind:
face</cite>”, <cite>“divk: cell-face</cite>” (default), <cite>“divk: face</cite>”, <cite>“standard: cell</cite>”,
<cite>“divk: cell-face-twin</cite>” and <cite>“divk: cell-grad-face-twin</cite>”.  Symmetry
preserving methods are the divk-family of methods and the classical
cell-centered method (<cite>“standard: cell</cite>”). The first part of the name
indicates the base scheme.  The second part (after the semi-column)
indicates required components of the composite vector that must be provided
by a physical PK.</li>
<li><cite>“discretization secondary</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the most robust
discretization method that is used when the primary selection fails to
satisfy all a priori conditions.  This is typically <cite>“mfd: default</cite>”, and is
used only when an MFD <cite>“discretization primary</cite>” is used.</li>
<li><cite>“schema</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines the operator stencil. It is a collection of
geometric objects.  Typically this is set by the implementation and is not provided.</li>
<li><cite>“preconditioner schema</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{face,cell}</strong> Defines the
preconditioner stencil.  It is needed only when the default assembling
procedure is not desirable. If skipped, the <cite>“schema</cite>” is used instead.
In addition to the default, <strong>{face}</strong> may be used, which forms the Schur
complement.</li>
<li><cite>“consistent faces</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> may contain a <cite>“preconditioner</cite>” and
<cite>“linear operator</cite>” list (see sections <a href="#id168"><span class="problematic" id="id169">Preconditioners_</span></a> and <a href="#id170"><span class="problematic" id="id171">LinearSolvers_</span></a>
respectively).  If these lists are provided, and the <cite>“discretization
primary</cite>” is of type <cite>“mfd: *</cite>”, then the diffusion method
UpdateConsistentFaces() can be used.  This method, given a set of cell
values, determines the faces constraints that satisfy the constraint
equation in MFD by assembling and inverting the face-only system.  This is
not currently used by any Amanzi PKs.</li>
<li><cite>“diffusion tensor</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> allows us to solve problems with symmetric and
non-symmetric (but positive definite) tensors. Available options are <em>symmetric</em>
(default) and <em>nonsymmetric</em>.</li>
</ul>
<p>Additional options for MFD with the gravity term include:</p>
<ul class="simple">
<li><cite>“gravity term discretization</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> selects a model for discretizing the
gravity term. Available options are <cite>“hydraulic head</cite>” (default) and <cite>“finite volume</cite>”.
The first option starts with equation for the shifted solution, i.e. the hydraulic
head, and derives gravity discretization by the reserve shifting.
The second option is based on the divergence formula.</li>
</ul>
</div>
<div class="section" id="operatoradvection">
<h3><a class="toc-backref" href="#id133">OperatorAdvection</a><a class="headerlink" href="#operatoradvection" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PDE_AdvectionUpwind</span></code> assembles the discrete form of:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot (q C)\]</div>
<p>which advects quantity <span class="math notranslate nohighlight">\(C\)</span> with fluxes <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>This is a simple, first-order donor-upwind scheme, and is recommended
for use in diffusion-dominated advection-diffusion equations.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../input_spec.html" class="btn btn-neutral float-left" title="Input Specification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, jointly shared by contributor institutions

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>